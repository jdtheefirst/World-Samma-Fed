"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[432],{59209:function(e,n,t){var r=t(23029),o=t(92901),i=t(6919),a=t(85501),s=t(22107),c=t(39081),l=t(7189),u=t(65043),d=t(70579),f=function(e){function n(e){var t;return(0,r.A)(this,n),(t=(0,i.A)(this,n,[e])).state={hasError:!1},t}return(0,a.A)(n,e),(0,o.A)(n,[{key:"componentDidCatch",value:function(e,n){console.error(e,n)}},{key:"render",value:function(){return this.state.hasError?(0,d.jsxs)(s.a,{display:"flex",justifyContent:"center",alignItems:"center",background:"whitesmoke",width:"100%",height:"100%",children:[" ",(0,d.jsxs)(s.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[" ",(0,d.jsx)(c.E,{fontSize:"2xl",children:"An error occurred. Please "}),(0,d.jsx)(l.N,{color:"teal.500",href:"/dashboard",children:"Go Back..."})]})]}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}])}(u.Component);n.A=f},10554:function(e,n,t){var r=t(90675),o=t(10467),i=t(79722).A.create();i.interceptors.response.use(function(){var e=(0,o.A)((0,r.A)().mark((function e(n){return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)})),n.A=i},53747:function(e,n,t){t.d(n,{ZU:function(){return f},bK:function(){return d},tJ:function(){return u},uS:function(){return h}});var r=t(90675),o=t(5544),i=t(10467),a=t(79722),s=t(65043),c=t(42104),l=t(97665),u=l.z.object({name:l.z.string().min(2,"Name must be at least 2 characters").max(50,"Name must be at most 50 characters"),otherName:l.z.string().min(2,"Other name must be at least 2 characters").max(50,"Other name must be at most 50 characters"),email:l.z.string().email("Invalid email address"),gender:l.z.enum(["male","female","other"]),password:l.z.string().min(4,"Password must be at least 8 characters long").max(100,"Password must be at most 100 characters"),confirmPassword:l.z.string().min(4,"Confirm password must be at least 8 characters long").max(100,"Confirm password must be at most 100 characters").refine((function(e,n){return e===n.parent.password}),{message:"Passwords do not match"}),passport:l.z.string().regex(/^\d{8,15}$/,"Invalid passport/ID number"),selectedCountry:l.z.string().min(2,"Country is required"),provinces:l.z.string().optional(),language:l.z.string().min(2,"Language is required"),pic:l.z.string().url("Profile picture is required")});function d(e){var n=(0,s.useState)(null),t=(0,o.A)(n,2),r=t[0],i=t[1],a=(0,s.useRef)(null);return(0,s.useEffect)((function(){if(e&&e.token){if(!a.current){var n=e._id,t=(0,c.io)("/",{query:{token:e.token,userId:n}});return t.on("connect",(function(){console.log("connected"),i(t)})),t.on("disconnect",(function(e){console.log("Socket.IO disconnected due to:",e),"io server disconnect"===e&&t.connect()})),t.on("reconnect_attempt",(function(e){console.log("Reconnection attempt ".concat(e))})),t.on("error",(function(e){console.error("Socket.IO error:",e)})),a.current=t,function(){t&&t.disconnect(),a.current=null}}i(a.current)}}),[e]),r}function f(e,n,t,r){return p.apply(this,arguments)}function p(){return(p=(0,i.A)((0,r.A)().mark((function e(n,t,o,i){var s,c;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,s={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(o.token)}},e.next=6,a.A.post("/api/paycheck/makepaymentmpesa/".concat(o._id,"?amount=").concat(n),{phoneNumber:t},s);case 6:c=e.sent,c.data&&i({title:"You have been prompt to finish your subscription process",status:"info",duration:1e3,position:"bottom"}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}function h(e,n,t){return m.apply(this,arguments)}function m(){return(m=(0,i.A)((0,r.A)().mark((function e(n,t,o){var i,s;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,i={headers:{"Content-type":"application/json"}},e.next=6,a.A.post("/api/paycheck/donationsmpesa?amount=".concat(n),{phoneNumber:t},i);case 6:s=e.sent,s.data&&o({title:"You have been prompt to finish your subscription process",status:"info",duration:1e3,position:"bottom"}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}},20200:function(e,n){n.A=function(e){var n=new Date(e),t=new Date-n,r=Math.floor(t/1e3),o=Math.floor(r/60),i=Math.floor(o/60),a=Math.floor(i/24);if(r<60)return"Just now";if(o<60)return"".concat(o," minute").concat(1===o?"":"s"," ago");if(i<24)return"".concat(i," hour").concat(1===i?"":"s"," ago");if(1===a)return"Yesterday";if(a<7)return"".concat(a," day").concat(1===a?"":"s"," ago");return n.toLocaleDateString("en-US",{hour:"numeric",minute:"numeric",month:"long",day:"numeric",year:"numeric"})}},33432:function(e,n,t){t.r(n),t.d(n,{default:function(){return ce}});var r,o,i,a,s,c=t(89379),l=t(60436),u=t(90675),d=t(10467),f=t(5544),p=t(65043),h=t(59209),m=t(30502),x=t(22107),b=t(42703),g=t(42837),v=t(57528),y=t(39081),A=t(1529),j=t(82639),w=t(70579),C=A.Ay.div(r||(r=(0,v.A)(["\n  display: flex;\n  justify-content: center;\n  align-items: flex-end;\n  position: relative;\n  width: 100%;\n  padding: 0;\n  margin: 0;\n"]))),k=A.Ay.div(o||(o=(0,v.A)(["\n  display: flex;\n  width: 30%;\n  height: 50px;\n  border: none;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  font-weight: bold;\n  padding: 0;\n  margin: 0;\n"]))),S=(0,A.i7)(i||(i=(0,v.A)(["\n  from {\n    width: 1%; /* Adjust the initial width as needed */\n  }\n  to {\n    width: ","%;\n  }\n"])),(function(e){return 10*(e.level+1.2)})),E=(0,A.i7)(a||(a=(0,v.A)(["\n  0%, 100% {\n    background-color: #ed7d66; /* Slightly less green color */\n  }\n  50% {\n    background-color: #66d171; /* Default green color */\n  }\n"]))),z=A.Ay.div(s||(s=(0,v.A)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 50px;\n  height: 14px;\n  background-color: #66d171;\n  border-radius: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  margin: 0;\n  padding: 0;\n  width: ","%;\n  animation: "," 2s ease-in-out,\n    "," 3s ease-in-out infinite;\n"])),(function(e){return 10*(e.level+1)}),S,E),_=function(e){var n=e.userBelt,t=["Guest","Beginner","Yellow","Orange","Red","Purple","Green","Blue","Brown","Black"].indexOf(n);return(0,w.jsxs)(C,{children:[["Guest","grey","#baba30","orange","red","purple","green","blue","brown","black"].map((function(e,n){return(0,w.jsx)(k,{children:(0,w.jsx)(y.E,{marginTop:-3,fontWeight:{base:"sm",md:"md"},fontSize:{base:"10px",md:"md"},textAlign:"center",children:n>0?(0,w.jsx)(j.n7_,{style:{color:e,fontSize:"1.5rem"}}):e})},n)})),(0,w.jsxs)(z,{level:t,children:[" ",(0,w.jsxs)(y.E,{textAlign:"center",fontSize:"small",p:1,children:[10*(t+1),"%"]})," "]})]})},P=t(5371),I=t(7189),D=t(29301),N=t(44093),B=t(96870),F=t(73203),R=t(11054),M=t(76524),O=t(15071),Y=t(35929),W=t(67516),q=t(20972),L=t(35699),U=t(82459),$=t(56529),G=t(30059),T=t(53747),Z=t(56818),K=t(79722);function J(e){var n=e.course,t=(0,m.d)(),r=(0,Z.a)(),o=r.user,i=r.setUser,a=(0,p.useState)(!1),s=(0,f.A)(a,2),l=s[0],h=s[1],b=(0,p.useState)(""),g=(0,f.A)(b,2),v=g[0],A=g[1],j=(0,B.j)(),C=j.isOpen,k=j.onOpen,S=j.onClose,E=(0,T.bK)(null===o||void 0===o?void 0:o.token);(0,p.useEffect)((function(){if(E)return E.on("noPayment",(function(e){t({title:e,description:"Subscription unsuccessful",status:"info",duration:5e3,position:"bottom"})})),E.on("userUpdated",function(){var e=(0,d.A)((0,u.A)().mark((function e(n){return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i((function(e){return(0,c.A)((0,c.A)({},e),{},{belt:n.belt})})),t({title:"Successfully updated",description:"Ranked ".concat(n.belt),status:"info",duration:5e3,position:"bottom"});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),function(){E.off("userUpdated"),E.off("noPayment")}}),[i,t,E]);var z=function(){var e=(0,d.A)((0,u.A)().mark((function e(){var n,r,a;return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n={headers:{Authorization:"Bearer ".concat(o.token)}},e.next=6,K.A.get("/api/user/update",n);case 6:r=e.sent,a=r.data,i((function(e){return(0,c.A)((0,c.A)({},e),{},{belt:a.belt})})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),e.t0.response&&400===e.t0.response.status?t({title:"Belt achieved!",description:e.t0.response.data.message,status:"info",duration:5e3,isClosable:!0,position:"bottom"}):(console.error("An error occurred:",e.t0),t({title:"An Error Occurred!",description:"Please try again later.",status:"error",duration:5e3,isClosable:!0,position:"bottom"}));case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(D.$,{borderRadius:20,fontSize:"small",background:"#a432a8",textColor:"white",_hover:{color:"black"},m:1,onClick:function(){var e=o&&o.certificates.length,r=n.id-1;o&&"Guest"===o.belt&&0===r||e+1===r+1?k():o&&o.belt===n.title?t({title:"Currently on this course",description:"You don't need to enroll in this course.",status:"warning",duration:5e3,isClosable:!0}):t({title:"Course Unavailable",description:"You don't meet the requirements to enroll in this course.",status:"warning",duration:5e3,isClosable:!0})},children:"Enroll"}),(0,w.jsxs)(F.aF,{size:"lg",onClose:function(){h(!1),S()},isOpen:C,isCentered:!0,children:[(0,w.jsx)(R.m,{bg:"blackAlpha.300",backdropFilter:"blur(10px) hue-rotate(90deg)"}),(0,w.jsxs)(M.$,{display:"flex",flexDirection:"column",justifyContent:"center",width:"100%",children:[(0,w.jsx)(O.r,{fontSize:"40px",fontFamily:"Work sans",children:(0,w.jsxs)(y.E,{textAlign:"center",fontSize:"sm",fontWeight:500,p:2,px:3,color:"green.500",rounded:"full",children:["Elevate Your Craft: ",n.title]})}),(0,w.jsx)(Y.s,{}),(0,w.jsxs)(W.c,{children:[(0,w.jsx)(G.ag,{options:{clientId:"AZAdYFR_SbadcgOcCLYn9ajkReJTZmOCnEeAvQ3xPYAE5BMYFBHi4vDeILfNwBO-hh-8wfyGC9lNeB1I"},children:(0,w.jsx)(G.JV,{createOrder:function(e,n){return n.order.create({purchase_units:[{amount:{currency_code:"USD",value:12..toFixed(2)}}]})},onApprove:function(){var e=(0,d.A)((0,u.A)().mark((function e(n,r){return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:return e.abrupt("return",r.order.capture().then((function(e){t({title:"Success",description:n.subscriptionID,status:"info",duration:3e3,isClosable:!0,position:"bottom"})})));case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),onCancel:function(){t({title:"Cancelled",description:"Subscription Unsuccessful",status:"info",isClosable:!0,position:"bottom"})}})}),(0,w.jsxs)(D.$,{fontSize:"small",width:"100%",bg:(0,N.dU)("green.100","green.900"),onClick:function(){h(!0)},p:0,children:[(0,w.jsx)(q._,{height:5,width:"auto",src:"https://res.cloudinary.com/dvc7i8g1a/image/upload/v1694007922/mpesa_ppfs6p.png",alt:"",loading:"lazy"})," ","Pay via Mpesa"]}),l&&(0,w.jsxs)(x.a,{m:3,children:[(0,w.jsx)(y.E,{textAlign:"center",justifyContent:"center",fontSize:"2xl",children:"Enter Your Mpesa Phone Number"}),(0,w.jsx)(L.p,{fontSize:"small",color:"green.400",fontWeight:"bold",placeholder:"Enter phone number",textAlign:"center",type:"number",onChange:function(e){return A(e.target.value)},value:v,minLength:10,maxLength:10}),(0,w.jsx)(U.c,{p:2}),(0,w.jsx)(D.$,{width:"100%",onClick:function(){(0,T.ZU)("4500",v,o,t),h(!1),t({title:"Wait as message is sent",status:"loading",isClosable:!0,position:"bottom",duration:5e3})},isDisabled:v.length!==parseInt(10),colorScheme:"green",children:"Proceed"}),(0,w.jsx)(y.E,{textAlign:"center",justifyContent:"center",children:"You'll be sent a Message"})]})]}),(0,w.jsx)($.j,{display:"flex",children:" Wait as PayPal processes..."})]})]})]})}var X=function(e){var n=e.courses,t=e.user,r=function(e,n){var t=document.createElement("a");t.href=n,t.download="".concat(e,"BeltCertificate.pdf"),t.click()},o=["#baba30","orange","red","purple","green","blue","brown","black"];return(0,w.jsxs)(x.a,{display:"flex",flexDir:"column",alignItems:"center",justifyContent:"center",width:"100%",p:4,backgroundColor:"white",children:[(0,w.jsx)(y.E,{fontSize:"20px",fontWeight:"medium",children:"My Programs"}),n.map((function(e,n){return(0,w.jsxs)(P.s,{display:"flex",alignItems:"center",justifyContent:"space-between",m:4,p:{base:"1",md:"4"},width:{base:"90%",md:"70%"},border:"1px",borderRadius:5,children:[(0,w.jsxs)(x.a,{children:[(0,w.jsxs)(x.a,{fontSize:"larger",fontWeight:"medium",children:[(0,w.jsx)(y.E,{children:e.title}),(0,w.jsx)(j.n7_,{style:{color:o[n],fontSize:"3rem"}})]}),e.title===(null===t||void 0===t?void 0:t.belt)&&(0,w.jsx)(I.N,{href:"/courses/".concat(e.id),style:{textDecoration:"none",color:"inherit"},p:0,m:0,children:"Continue"})]}),t&&t.certificates&&t.certificates[n]?(0,w.jsx)(D.$,{onClick:r(e.title,t.certificates[n]),borderRadius:20,fontSize:"small",border:"none",children:"Download Certificate"}):(0,w.jsxs)(x.a,{display:"flex",flexDir:"column",justifyContent:"space-between",alignItems:"center",children:[(0,w.jsx)(J,{course:e}),(0,w.jsx)(y.E,{fontSize:"sm",fontWeight:400,bg:(0,N.dU)("green.50","green.900"),p:3,px:3,color:"green.500",rounded:"full",children:"$12.00 only"})]})]},e.id)}))]})},H=t(76659),Q=t(20200),V=t(31462),ee=t(89698);var ne=function(e){var n,t,r,o,i,a,s,c,l=e.m,u=(0,Z.a)(),d=u.user,f=u.setSelectedChat,p=u.setSend,h="6693a995f6295b8bd90d9301",m=null===d||void 0===d?void 0:d._id;return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(x.a,{display:"flex",flexDir:"column",position:"relative",fontSize:"small",onClick:function(){var e,n,t;(null===(e=l.sender)||void 0===e?void 0:e._id)!==m&&(f(null===(n=l.sender)||void 0===n?void 0:n._id),p(null===(t=l.sender)||void 0===t?void 0:t.name))},children:[(0,w.jsxs)(x.a,{fontSize:"smaller",textDecor:"underline",textAlign:"end",children:[(null===(n=l.sender)||void 0===n?void 0:n._id)===h&&m!==h&&(0,w.jsxs)(x.a,{display:"flex",justifyContent:"flex-end",alignItems:"center",width:"100%",children:["From:","\xa0",(0,w.jsxs)(x.a,{display:"flex",children:[(0,w.jsx)(y.E,{fontSize:"bold",children:"WSF"}),(0,w.jsx)(ee.Tcv,{style:{color:"blue"}})]})]}),(null===(t=l.sender)||void 0===t?void 0:t._id)===m&&(null===(r=l.recipient)||void 0===r?void 0:r._id)===h&&(0,w.jsxs)(x.a,{display:"flex",children:["Sent to","\xa0","WSF",(0,w.jsx)(ee.Tcv,{style:{color:"blue"}})]}),(null===(o=l.sender)||void 0===o?void 0:o._id)!==h&&(0,w.jsxs)(y.E,{children:["From","\xa0",null===(i=l.sender)||void 0===i?void 0:i.name]}),(null===(a=l.sender)||void 0===a?void 0:a._id)===h&&(0,w.jsxs)(y.E,{children:["Sent to","\xa0",null===(s=l.recipient)||void 0===s?void 0:s.name]})]}),l.content,(0,w.jsxs)(y.E,{display:"flex",textAlign:"right",m:0,p:0,fontSize:"2xs",children:[(null===(c=l.sender)||void 0===c?void 0:c._id)===d._id?(0,w.jsx)(V.ohF,{}):"",(0,Q.A)(l.createdAt)]})]})})},te=function(e){var n=e.messages,t=(0,Z.a)().user;return(0,w.jsx)("div",{style:{width:"100%",height:"90%",overflowY:"auto"},children:(0,w.jsx)(x.a,{display:"flex",justifyContent:"start",alignItems:"center",flexDir:"column",background:"white",minH:"100vh",p:4,mb:"10",width:"100%",children:n.map((function(e,n){var r;if(!e&&!t)return null;var o=(null===(r=e.sender)||void 0===r?void 0:r._id)===t._id;return(0,w.jsx)(x.a,{bg:o?"#BEE3F8":"#B9F5D0",borderRadius:"20px",p:"5px 15px",mb:"2",maxW:"75%",alignSelf:o?"flex-end":"flex-start",children:(0,w.jsx)(ne,{m:e})},n)}))})})},re=t(73216),oe=t(50423),ie=function(e){var n=e.onClose,t=(0,m.d)(),r=(0,p.useState)(""),o=(0,f.A)(r,2),i=o[0],a=o[1],s=(0,p.useState)(["WSF","Coach","Provincial Coach","National Coach"]),c=(0,f.A)(s,2),h=c[0],g=c[1],v=(0,p.useState)(null),A=(0,f.A)(v,2),j=A[0],C=A[1],k=(0,p.useState)(null),S=(0,f.A)(k,2),E=S[0],z=S[1],_=(0,p.useState)(),P=(0,f.A)(_,2),I=P[0],N=P[1],B=(0,p.useState)(!1),F=(0,f.A)(B,2),R=F[0],M=F[1],O=(0,p.useState)(!1),Y=(0,f.A)(O,2),W=Y[0],q=Y[1],U=(0,Z.a)(),$=U.user,G=U.selectedChat,J=U.setSelectedChat,X=U.send,Q=U.setSend,V=U.messages,ee=U.setMessages,ne=U.national,ie=U.province,ae=(0,re.Zp)(),se="6693a995f6295b8bd90d9301",ce=(0,T.bK)(null===$||void 0===$?void 0:$.token);(0,p.useEffect)((function(){((null===$||void 0===$?void 0:$._id)===se||null!==$&&void 0!==$&&$.coach||(null===ie||void 0===ie?void 0:ie.provincialCoach._id)===(null===$||void 0===$?void 0:$._id)||(null===ne||void 0===ne?void 0:ne.nationalCoach._id)===(null===$||void 0===$?void 0:$._id))&&M(!0)}),[$,ne,ie,M]),(0,p.useEffect)((function(){void 0===$.provinces&&g((function(e){return e.filter((function(e){return"Provincial Coach"!==e}))}))}),[$.provinces]),(0,p.useEffect)((function(){return"Coach"!==j||null!==$&&void 0!==$&&$.physicalCoach?"Provincial Coach"!==j||ie?"National Coach"!==j||ne?void 0:(C(null),ae("/national"),void t({title:"National Samma Association seat is empty!",description:"Apply for Interim",status:"info",duration:5e3,position:"bottom-left"})):(C(null),ae("/province"),void t({title:"Provincial Samma Association seat is empty!",description:"Apply for Interim",status:"info",duration:5e3,position:"bottom-left"})):(ae("/clubs"),t({title:"You've not joined a Club",description:"Join a club or make one as you'd please",status:"info",duration:5e3,position:"bottom-left"}),void C(null))}),[j,ae,$,ne,ie,t]);var le=(0,p.useCallback)((0,d.A)((0,u.A)().mark((function e(){var n,r,o;return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n={headers:{Authorization:"Bearer ".concat($.token)}},N(!0),e.next=7,K.A.get("/api/message/".concat($._id),n);case 7:r=e.sent,o=r.data,ee(o),N(!1),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(2),console.log(e.t0),N(!1),t({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 18:case"end":return e.stop()}}),e,null,[[2,13]])}))),[t,$]);(0,p.useEffect)((function(){le()}),[le]),(0,p.useEffect)((function(){"Coach"===j?z($.physicalCoach):"WSF"===j&&$?z($.wsf):"Provincial Coach"===j&&ie?z(ie.provincialCoach._id):"National Coach"===j&&ne&&z(ne.nationalCoach._id)}),[j,ne,ie,$,z]),(0,p.useEffect)((function(){G&&z(G)}),[G,z]);var ue=function(){var e=(0,d.A)((0,u.A)().mark((function e(n){var r,o,s,c,d;return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&"click"===n.type||n&&"Enter"===n.key)){e.next=27;break}if(q(!0),r=$._id,j||R){e.next=7;break}return t({title:"Select a recipient",description:"Please choose whom you want to chat with.",status:"info",duration:5e3,isClosable:!0,position:"bottom"}),q(!1),e.abrupt("return");case 7:if(!R||G||r===se){e.next=11;break}return t({title:"Select a recipient!",description:"Please choose whom you want to reply to...",status:"info",duration:5e3,isClosable:!0,position:"bottom"}),q(!1),e.abrupt("return");case 11:return e.prev=11,o={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat($.token)}},e.next=15,K.A.post("/api/message",{sender:E,content:i,userId:r},o);case 15:s=e.sent,c=s.data,r===se?(d={content:i.trim(),createdAt:new Date,recipient:{WSF:null,_id:"65c7549721abc4f629ae5009",name:"Broadcast",otherName:"Ngatia",email:"josephmpesa23@gmail.com"},sender:{_id:"6693a995f6295b8bd90d9301",name:"j",otherName:"e",email:"almanobe2@gmail.com"},updatedAt:"2024-07-01T16:26:45.964Z",__v:0,_id:"6682d8c501209935692efb9e"},ee((function(e){return[].concat((0,l.A)(e),[d])}))):(ee((function(e){return[].concat((0,l.A)(e),[c])})),ce.emit("new message",c)),q(!1),a(""),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(11),console.error("Failed to send message:",e.t0),q(!1),t({title:"Failed to send the Message",description:"Please try again after some time",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 27:case"end":return e.stop()}}),e,null,[[11,22]])})));return function(n){return e.apply(this,arguments)}}();return(0,w.jsxs)(x.a,{display:"flex",flexDirection:"column",position:"fixed",bottom:"0",right:"1",height:"90vh",width:{base:"100%",md:"60%"},borderRadius:4,boxShadow:"dark-lg",p:"2",rounded:"md",bg:"white",zIndex:11,children:[(0,w.jsx)(D.$,{p:2,onClick:function(){n()},border:"none",children:"X"}),(0,w.jsxs)(x.a,{p:2,top:"0",left:"0",height:"90%",display:"flex",flexDir:"column",justifyContent:"center",alignItems:"center",width:"100%",background:"whitesmoke",children:[!j&&!R&&(0,w.jsxs)(x.a,{display:"flex",flexDir:"column",bg:"transparent",children:[(0,w.jsx)(y.E,{children:"Select whom you want to chat with:"}),h.map((function(e){return(0,w.jsx)(D.$,{bg:"transparent",onClick:function(){return C(e)},border:"none",p:"2",children:e},e)}))]}),I?(0,w.jsx)(H.y,{speed:"0.65s",size:"xl"}):(0,w.jsx)(te,{messages:V}),(0,w.jsxs)(x.a,{position:"absolute",bottom:0,width:"100%",children:[R&&(0,w.jsxs)(x.a,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",children:["Replying to ",G?X:"(select a message please)",G&&(0,w.jsx)(D.$,{onClick:function(){J(null),Q(null)},background:"transparent",textColor:"red",border:"none",children:"X"})]}),j&&(0,w.jsxs)(x.a,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",children:["Chatting with ",j,(0,w.jsx)(D.$,{onClick:function(){return C(null)},background:"transparent",textColor:"red",border:"none",children:"X"})]}),(0,w.jsxs)(x.a,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",background:"white",p:2,children:[(0,w.jsx)(L.p,{placeholder:"Type your message...",value:i,onChange:function(e){return a(e.target.value)}}),(0,w.jsx)(b.K,{isLoading:W,border:"none",onClick:function(e){return ue(e)},p:0,m:1,children:(0,w.jsx)(oe.sfP,{})})]})]})]})]})},ae=t(10554),se=t(6720),ce=function(e){var n=e.courses,t=(0,p.useState)(!1),r=(0,f.A)(t,2),o=r[0],i=r[1],a=(0,Z.a)(),s=a.user,v=a.setUser,y=a.setClub,A=a.setMessages,j=a.notification,C=a.setNotification,k=a.setNational,S=a.setProvince,E=(0,re.Zp)(),z=(0,p.useState)(!1),P=(0,f.A)(z,2),I=P[0],D=P[1],N=(0,m.d)(),B=(0,T.bK)(s),F=(0,p.useState)(!1),R=(0,f.A)(F,2),M=R[0],O=R[1];(0,p.useEffect)((function(){B&&(O(B.connected),B.on("connect",(function(){O(!0)})),B.on("disconnect",(function(){O(!1)})))}),[B]);var Y=(0,p.useCallback)((0,d.A)((0,u.A)().mark((function e(){var n,t;return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==s&&void 0!==s&&s.coach){e.next=2;break}return e.abrupt("return");case 2:return n={headers:{Authorization:"Bearer ".concat(s.token)}},e.prev=3,e.next=6,ae.A.get("/api/clubs/".concat(s.coach),n);case 6:t=e.sent,y(t.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error("Error fetching Club:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])}))),[s]);(0,p.useEffect)((function(){s&&Y()}),[s,Y]),(0,p.useEffect)((function(){if(M){var e=function(e){C([e].concat((0,l.A)(j))),function(e,n){if("granted"===Notification.permission){new Notification(e,n);var t=new Audio("https://s3.amazonaws.com/freecodecamp/drums/Give_us_a_light.mp3");t.addEventListener("error",(function(e){console.error("Audio playback error:",e)})),t.play().catch((function(e){console.error("Audio playback error:",e)}))}else"denied"!==Notification.permission&&Notification.requestPermission().then((function(t){if("granted"===t){new Notification(e,n);var r=new Audio("https://s3.amazonaws.com/freecodecamp/drums/Give_us_a_light.mp3");r.addEventListener("error",(function(e){console.error("Audio playback error:",e)})),r.play().catch((function(e){console.error("Audio playback error:",e)}))}}))}("New Message",{body:"New message from ".concat(e.sender.name),icon:"".concat(e.sender.pic)}),A((function(n){return[].concat((0,l.A)(n),[e])}))},n=function(e){v((function(n){return(0,c.A)((0,c.A)({},n),{},{provinceRequests:[].concat((0,l.A)(n.provinceRequests),[e.provincialCoach])})}))},t=function(e){v((function(n){return(0,c.A)((0,c.A)({},n),{},{nationalRequests:[].concat((0,l.A)(n.nationalRequests),[e.nationalCoach])})}))},r=function(e){v((function(n){return(0,c.A)((0,c.A)({},n),{},{certificates:e.certificates,belt:e.belt})}))};return B.on("provincial request",n),B.on("national request",t),B.on("certificates",r),B.on("message received",e),function(){B.off("provincial request",n),B.off("national request",t),B.off("certificates",r),B.off("message received",e)}}}),[B,E,j,M]);var W=(0,p.useCallback)((0,d.A)((0,u.A)().mark((function e(){var n,t,r,o,i,a,c;return(0,u.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=3;break}return E("/"),e.abrupt("return");case 3:return n={headers:{Authorization:"Bearer ".concat(s.token)}},e.prev=4,e.next=7,Promise.all([ae.A.get("/api/province/officials/".concat(s.country,"/").concat(s.provinces),n),ae.A.get("/api/national/officials/".concat(s.country,"/").concat(s.provinces),n)]);case 7:t=e.sent,r=(0,f.A)(t,2),o=r[0],i=r[1],a=o.data,c=i.data,a.length>0&&(S(a),console.log(a)),c.length>0&&k(c),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),e.t0.response&&401===e.t0.response.status?(N({title:"Your session has expired",description:"Logging out in 8 seconds",duration:8e3,status:"loading",position:"bottom"}),console.log(e.t0),setTimeout((function(){localStorage.removeItem("userInfo"),E("/")}),8e3)):(console.log(e.t0),N({title:"An Error Occurred!",description:"Try again after sometime.",status:"error",duration:5e3,isClosable:!0}));case 20:case"end":return e.stop()}}),e,null,[[4,17]])}))),[s,E,N]);return(0,p.useEffect)((function(){s?W():E("/dashboard")}),[W,E,s]),(0,w.jsx)(h.A,{fallback:(0,w.jsx)("p",{style:{color:"white"},children:"Something went wrong"}),userSelect:"none",children:(0,w.jsxs)(x.a,{display:"flex",alignItems:"center",justifyContent:"center",flexDir:"column",width:"100%",background:"white",position:"relative",children:[(0,w.jsx)(g.A,{}),(0,w.jsx)(x.a,{width:"100%",mt:20,children:(0,w.jsx)(_,{userBelt:null===s||void 0===s?void 0:s.belt})}),(0,w.jsx)(X,{courses:n,user:s}),o&&(0,w.jsx)(ie,{onClose:function(){return i(!1)}}),(0,w.jsx)(b.K,{display:o?"none":"flex",position:"fixed",bottom:"8%",right:"10%",icon:(0,w.jsx)(se.X5G,{style:{width:I?"60px":"40px",transition:"width 0.3s ease-in-out",color:"teal",fontSize:"40px",border:"none"}}),backgroundColor:"orange",p:"2",boxSize:"auto",border:"none",_hover:{backgroundColor:"white"},onClick:function(){return i(!0)},onMouseEnter:function(){return D(!0)},onMouseLeave:function(){return D(!1)},borderRadius:"full"})]})})}}}]);
//# sourceMappingURL=432.e1333f14.chunk.js.map