"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[42],{35042:function(e,n,r){r.r(n);var t=r(90675),c=r(10467),s=r(5544),o=r(65043),u=r(60184),a=r(51064),i=r(70579);n.default=function(){var e=(0,o.useState)(null),n=(0,s.A)(e,2),r=n[0],l=n[1],d=(0,o.useState)(null),f=(0,s.A)(d,2),g=f[0],p=f[1],v=(0,o.useState)(!1),m=(0,s.A)(v,2),h=m[0],b=m[1],j=(0,o.useState)(!1),x=(0,s.A)(j,2),S=x[0],k=x[1],w=(0,o.useState)(!1),N=(0,s.A)(w,2),R=N[0],A=N[1],C=(0,o.useRef)(null),T=(0,o.useRef)(null),M=(0,o.useRef)(null);(0,o.useEffect)((function(){return M.current||(M.current=new WebSocket("/ws/"),M.current.onopen=function(){A(!0),console.log("WebSocket connected to Janus")},M.current.onclose=function(){A(!1),console.log("WebSocket closed Janus connection")},M.current.onerror=function(e){console.error("WebSocket error",e)}),function(){M.current&&M.current.close()}}),[]),(0,o.useEffect)((function(){return R&&a.A.init({debug:"all",callback:function(){var e=new a.A({server:"/ws/",success:function(){P(e)},error:function(e){console.error("Janus error:",e)}});l(e)}}),function(){r&&r.destroy()}}),[R]);var P=function(e){e.attach({plugin:"janus.plugin.rtmp",success:function(e){p(e),console.log("RTMP plugin attached!"),E()},error:function(e){console.error("Error attaching RTMP plugin:",e)},webrtcState:function(e){k(e),console.log("WebRTC peer connection is ",e?"up":"down")},onmessage:function(e,n){console.log("Message received from RTMP plugin:",e)},onlocalstream:function(e){C.current.srcObject=e}})},E=function(){var e=(0,c.A)((0,t.A)().mark((function e(){var n;return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:n=e.sent,C.current.srcObject=n,T.current=n,g&&g.createOffer({media:{video:!0,audio:!0,data:!1},stream:T.current,success:function(e){g.send({message:{request:"configure",audio:!0,video:!0},jsep:e})},error:function(e){console.error("Error creating WebRTC offer:",e)}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error accessing user media:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return(0,i.jsxs)("div",{className:"streaming-container",children:[(0,i.jsxs)("div",{className:"video-wrapper",children:[(0,i.jsx)("video",{ref:C,autoPlay:!0,muted:!0,className:"video-feed"}),!S&&(0,i.jsx)("div",{className:"overlay",children:"Connecting..."})]}),(0,i.jsxs)("div",{className:"control-panel",children:[(0,i.jsx)("h2",{children:"Live Stream Control"}),(0,i.jsxs)("div",{className:"status-indicators",children:[(0,i.jsx)("div",{className:"status ".concat(S?"connected":"disconnected"),children:S?"Connected":"Disconnected"}),(0,i.jsx)("div",{className:"status ".concat(h?"live":"idle"),children:h?"Live":"Idle"})]}),(0,i.jsxs)("div",{className:"controls",children:[(0,i.jsxs)("button",{onClick:function(){if(g){g.send({message:{request:"publish",rtmp_url:"rtmp://nginx/stream"},success:function(){console.log("Publishing to RTMP successfully!"),b(!0)},error:function(e){console.error("Error publishing to RTMP:",e)}})}else console.error("RTMP plugin not attached.")},disabled:h,className:"start-btn",children:[(0,i.jsx)(u.gSK,{})," Start Streaming"]}),(0,i.jsxs)("button",{onClick:function(){g&&(g.hangup(),b(!1),T.current&&T.current.getTracks().forEach((function(e){return e.stop()})))},disabled:!h,className:"stop-btn",children:[(0,i.jsx)(u.wFo,{})," Stop Streaming"]})]})]})]})}}}]);
//# sourceMappingURL=42.a12b9924.chunk.js.map