{"version":3,"file":"static/js/42.ab777b36.chunk.js","mappings":"qLAyIA,UApI0B,WACxB,IAAAA,GAA0BC,EAAAA,EAAAA,UAAS,MAAKC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAAjCI,EAAKF,EAAA,GAAEG,EAAQH,EAAA,GACtBI,GAAoCL,EAAAA,EAAAA,UAAS,MAAKM,GAAAJ,EAAAA,EAAAA,GAAAG,EAAA,GAA3CE,EAAUD,EAAA,GAAEE,EAAaF,EAAA,GAChCG,GAAkCT,EAAAA,EAAAA,WAAS,GAAMU,GAAAR,EAAAA,EAAAA,GAAAO,EAAA,GAA1CE,EAASD,EAAA,GAAEE,EAAYF,EAAA,GAC9BG,GAAkCb,EAAAA,EAAAA,WAAS,GAAMc,GAAAZ,EAAAA,EAAAA,GAAAW,EAAA,GAA1CE,EAASD,EAAA,GAAEE,EAAYF,EAAA,GACxBG,GAAgBC,EAAAA,EAAAA,QAAO,MAEvBC,EAAK,IAAIC,UAAU,uBACzBD,EAAGE,OAAS,kBAAMC,QAAQC,IAAI,sBAAuB,EACrDJ,EAAGK,QAAU,kBAAMF,QAAQC,IAAI,mBAAoB,EACnDJ,EAAGM,QAAU,SAACC,GAAK,OAAKJ,QAAQI,MAAM,kBAAmBA,EAAO,EAEhE,IAAMC,EAAI,IAAIP,UAAU,mBACxBO,EAAEN,OAAS,kBAAMC,QAAQC,IAAI,sBAAuB,EACpDI,EAAEH,QAAU,kBAAMF,QAAQC,IAAI,mBAAoB,EAClDI,EAAEF,QAAU,SAACC,GAAK,OAAKJ,QAAQI,MAAM,kBAAmBA,EAAO,EAE/D,IAAME,EAAI,IAAIR,UAAU,qCACxBQ,EAAEP,OAAS,kBAAMC,QAAQC,IAAI,sBAAuB,EACpDK,EAAEJ,QAAU,kBAAMF,QAAQC,IAAI,mBAAoB,EAClDK,EAAEH,QAAU,SAACC,GAAK,OAAKJ,QAAQI,MAAM,kBAAmBA,EAAO,GAE/DG,EAAAA,EAAAA,YAAU,WAiBR,OAhBAC,EAAAA,EAAMC,KAAK,CACTC,MAAO,MACPC,SAAU,WACR,IAAMC,EAAgB,IAAIJ,EAAAA,EAAM,CAC9BK,OAAQ,kBACRC,QAAS,WACPC,EAAiBH,EACnB,EACAR,MAAO,SAACA,GACNJ,QAAQI,MAAM,eAAgBA,EAChC,IAEFtB,EAAS8B,EACX,IAGK,WACD/B,GACFA,EAAMmC,SAEV,CACF,GAAG,IAEH,IAAMD,EAAmB,SAACH,GACxBA,EAAcK,OAAO,CACnBC,OAAQ,oBACRJ,QAAS,SAACK,GACRjC,EAAciC,GACdnB,QAAQC,IAAI,wBACd,EACAG,MAAO,SAACA,GACNJ,QAAQI,MAAM,+BAAgCA,EAChD,EACAgB,YAAa,SAACC,GACZ3B,EAAa2B,GACbrB,QAAQC,IAAI,6BAA8BoB,EAAK,KAAO,OACxD,EACAC,UAAW,SAACC,EAAKC,GACfxB,QAAQC,IAAI,qCAAsCsB,EACpD,EACAE,cAAe,SAACC,GACd/B,EAAcgC,QAAQC,UAAYF,CACpC,GAEJ,EA4BA,OACEG,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sBAAqBC,SAAA,EAClCF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeC,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOC,IAAKtC,EAAeuC,UAAQ,EAACC,OAAK,EAACL,UAAU,gBAClDrC,IAAauC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,UAASC,SAAC,sBAE1CF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeC,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,yBACJF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBC,SAAA,EAChCC,EAAAA,EAAAA,KAAA,OAAKF,UAAS,UAAAM,OAAY3C,EAAY,YAAc,gBAAiBsC,SAClEtC,EAAY,YAAc,kBAE7BuC,EAAAA,EAAAA,KAAA,OAAKF,UAAS,UAAAM,OAAY/C,EAAY,OAAS,QAAS0C,SACrD1C,EAAY,OAAS,aAG1BwC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,WAAUC,SAAA,EACvBF,EAAAA,EAAAA,MAAA,UACEQ,QA5Ca,WACrB,GAAKpD,EAAL,CAMAA,EAAWqD,QAAQ,CACjBZ,OAFc,2BAGdZ,QAAS,WACPd,QAAQC,IAAI,oCACZX,GAAa,EACf,EACAc,MAAO,SAACA,GACNJ,QAAQI,MAAM,4BAA6BA,EAC7C,GAXF,MAFEJ,QAAQI,MAAM,4BAelB,EA4BUmC,SAAUlD,EACVyC,UAAU,YAAWC,SAAA,EAErBC,EAAAA,EAAAA,KAACQ,EAAAA,IAAM,IAAG,uBAEZX,EAAAA,EAAAA,MAAA,UACEQ,QAhCY,WAChBpD,IACFA,EAAWwD,SACXnD,GAAa,GAEjB,EA4BUiD,UAAWlD,EACXyC,UAAU,WAAUC,SAAA,EAEpBC,EAAAA,EAAAA,KAACU,EAAAA,IAAM,IAAG,6BAMtB,C","sources":["pages/LivePage.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\r\nimport \"webrtc-adapter\";\r\nimport Janus from \"janus-gateway\";\r\nimport { FaPlay, FaStop, FaVideo } from \"react-icons/fa\";\r\n\r\nconst JanusRtmpStreamer = () => {\r\n  const [janus, setJanus] = useState(null);\r\n  const [rtmpPlugin, setRtmpPlugin] = useState(null);\r\n  const [streaming, setStreaming] = useState(false);\r\n  const [connected, setConnected] = useState(false);\r\n  const localVideoRef = useRef(null);\r\n\r\n  const ws = new WebSocket(\"ws://localhost:8188\");\r\n  ws.onopen = () => console.log(\"WebSocket connected\");\r\n  ws.onclose = () => console.log(\"WebSocket closed\");\r\n  ws.onerror = (error) => console.error(\"WebSocket error\", error);\r\n\r\n  const w = new WebSocket(\"ws://janus:8188\");\r\n  w.onopen = () => console.log(\"WebSocket connected\");\r\n  w.onclose = () => console.log(\"WebSocket closed\");\r\n  w.onerror = (error) => console.error(\"WebSocket error\", error);\r\n\r\n  const j = new WebSocket(\"ws://world-samma-fed-janus-1:8188\");\r\n  j.onopen = () => console.log(\"WebSocket connected\");\r\n  j.onclose = () => console.log(\"WebSocket closed\");\r\n  j.onerror = (error) => console.error(\"WebSocket error\", error);\r\n\r\n  useEffect(() => {\r\n    Janus.init({\r\n      debug: \"all\",\r\n      callback: () => {\r\n        const janusInstance = new Janus({\r\n          server: \"ws://janus:8188\",\r\n          success: () => {\r\n            attachRtmpPlugin(janusInstance);\r\n          },\r\n          error: (error) => {\r\n            console.error(\"Janus error:\", error);\r\n          },\r\n        });\r\n        setJanus(janusInstance);\r\n      },\r\n    });\r\n\r\n    return () => {\r\n      if (janus) {\r\n        janus.destroy();\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const attachRtmpPlugin = (janusInstance) => {\r\n    janusInstance.attach({\r\n      plugin: \"janus.plugin.rtmp\",\r\n      success: (pluginHandle) => {\r\n        setRtmpPlugin(pluginHandle);\r\n        console.log(\"RTMP plugin attached!\");\r\n      },\r\n      error: (error) => {\r\n        console.error(\"Error attaching RTMP plugin:\", error);\r\n      },\r\n      webrtcState: (on) => {\r\n        setConnected(on);\r\n        console.log(\"WebRTC peer connection is \", on ? \"up\" : \"down\");\r\n      },\r\n      onmessage: (msg, jsep) => {\r\n        console.log(\"Message received from RTMP plugin:\", msg);\r\n      },\r\n      onlocalstream: (stream) => {\r\n        localVideoRef.current.srcObject = stream;\r\n      },\r\n    });\r\n  };\r\n\r\n  const startStreaming = () => {\r\n    if (!rtmpPlugin) {\r\n      console.error(\"RTMP plugin not attached.\");\r\n      return;\r\n    }\r\n\r\n    const rtmpUrl = \"rtmp://nginx:1935/stream\";\r\n    rtmpPlugin.publish({\r\n      stream: rtmpUrl,\r\n      success: () => {\r\n        console.log(\"Publishing to RTMP successfully!\");\r\n        setStreaming(true);\r\n      },\r\n      error: (error) => {\r\n        console.error(\"Error publishing to RTMP:\", error);\r\n      },\r\n    });\r\n  };\r\n\r\n  const stopStreaming = () => {\r\n    if (rtmpPlugin) {\r\n      rtmpPlugin.hangup();\r\n      setStreaming(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"streaming-container\">\r\n      <div className=\"video-wrapper\">\r\n        <video ref={localVideoRef} autoPlay muted className=\"video-feed\" />\r\n        {!connected && <div className=\"overlay\">Connecting...</div>}\r\n      </div>\r\n      <div className=\"control-panel\">\r\n        <h2>Live Stream Control</h2>\r\n        <div className=\"status-indicators\">\r\n          <div className={`status ${connected ? \"connected\" : \"disconnected\"}`}>\r\n            {connected ? \"Connected\" : \"Disconnected\"}\r\n          </div>\r\n          <div className={`status ${streaming ? \"live\" : \"idle\"}`}>\r\n            {streaming ? \"Live\" : \"Idle\"}\r\n          </div>\r\n        </div>\r\n        <div className=\"controls\">\r\n          <button\r\n            onClick={startStreaming}\r\n            disabled={streaming}\r\n            className=\"start-btn\"\r\n          >\r\n            <FaPlay /> Start Streaming\r\n          </button>\r\n          <button\r\n            onClick={stopStreaming}\r\n            disabled={!streaming}\r\n            className=\"stop-btn\"\r\n          >\r\n            <FaStop /> Stop Streaming\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default JanusRtmpStreamer;\r\n"],"names":["_useState","useState","_useState2","_slicedToArray","janus","setJanus","_useState3","_useState4","rtmpPlugin","setRtmpPlugin","_useState5","_useState6","streaming","setStreaming","_useState7","_useState8","connected","setConnected","localVideoRef","useRef","ws","WebSocket","onopen","console","log","onclose","onerror","error","w","j","useEffect","Janus","init","debug","callback","janusInstance","server","success","attachRtmpPlugin","destroy","attach","plugin","pluginHandle","webrtcState","on","onmessage","msg","jsep","onlocalstream","stream","current","srcObject","_jsxs","className","children","_jsx","ref","autoPlay","muted","concat","onClick","publish","disabled","FaPlay","hangup","FaStop"],"sourceRoot":""}