"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[357],{10554:function(e,t,n){var r=n(90675),s=n(10467),a=n(79722).A.create();a.interceptors.response.use(function(){var e=(0,s.A)((0,r.A)().mark((function e(t){return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)})),t.A=a},59357:function(e,t,n){n.r(t);var r=n(60436),s=n(90675),a=n(10467),i=n(5544),o=n(65043),c=n(93748),u=n(85522),l=n(14377),d=n(3952),p=n(17118),h=n(30834),f=n(31377),m=n(38028),x=n(3224),g=n(25695),j=n(93461),v=n(24776),A=n(17921),b=n(69699),w=n(48024),k=n(79722),y=n(73216),C=n(10554),S=n(56818),z=n(70579);t.default=function(e){var t=e.user,n=(0,o.useState)([]),_=(0,i.A)(n,2),D=_[0],E=_[1],I=(0,o.useState)(!1),N=(0,i.A)(I,2),P=N[0],T=N[1],W=(0,o.useState)(!1),F=(0,i.A)(W,2),M=F[0],B=F[1],R=(0,o.useState)(void 0),$=(0,i.A)(R,2),O=$[0],U=$[1],H=(0,o.useState)(void 0),Y=(0,i.A)(H,2),J=Y[0],L=Y[1],V=(0,o.useState)(!1),Z=(0,i.A)(V,2),q=Z[0],G=Z[1],K=(0,o.useState)(!1),Q=(0,i.A)(K,2),X=Q[0],ee=Q[1],te=(0,o.useState)(""),ne=(0,i.A)(te,2),re=ne[0],se=ne[1],ae=(0,o.useState)(""),ie=(0,i.A)(ae,2),oe=ie[0],ce=ie[1],ue=(0,c.d)(),le=(0,y.Zp)(),de=(0,S.a)().setMessages,pe=function(e,n,r){if(console.log("Rejected submission with ID: ".concat(e)),ee(!0),e&&t)try{var i={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t.token)}},o={publicIds:[n.split("/").pop().split(".")[0],r.split("/").pop().split(".")[0]]};C.A.post("/api/submit/delete/".concat(e),o,i).then(function(){var e=(0,a.A)((0,s.A)().mark((function e(t){return(0,s.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(t.data),ee(!0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){ee(!1),e.response&&401===e.response.status&&(ue({title:"Your session has expired",description:"Logging out in less than 8 seconds",duration:8e3,status:"loading",position:"bottom"}),setTimeout((function(){localStorage.removeItem("userInfo"),le("/")}),8e3))}))}catch(c){ee(!1),console.error("Error fetching Club:",c)}},he=(0,o.useCallback)((0,a.A)((0,s.A)().mark((function e(){var n,r,a,i;return(0,s.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return le("/dashboard"),e.abrupt("return");case 3:if(n={headers:{Authorization:"Bearer ".concat(t.token)}},!J||!re){e.next=16;break}return e.prev=5,e.next=8,k.A.get("/api/user/certificate/".concat(re),{sendCertificate:J},n);case 8:r=e.sent,r.data,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0);case 15:return e.abrupt("return");case 16:return e.prev=16,e.next=19,k.A.get("/api/submit",n);case 19:a=e.sent,i=a.data,console.log(i),E(i),e.next=29;break;case 25:e.prev=25,e.t1=e.catch(16),console.log(e.t1),ue({title:"Error Occurred!",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 29:case"end":return e.stop()}}),e,null,[[5,12],[16,25]])}))),[ue,t,re,J]);(0,o.useEffect)((function(){he()}),[he]);var fe=function(){var e=(0,a.A)((0,s.A)().mark((function e(){var n,a,i,o;return(0,s.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe&&t&&re){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n=t._id,a={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(t.token)}},e.next=7,k.A.post("/api/message",{sender:re,content:oe,userId:n},a);case 7:i=e.sent,o=i.data,ce(""),de((function(e){return[].concat((0,r.A)(e),[o])})),socket.emit("new message",o),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),console.log(e.t0),ue({title:"Failed to send the Message",description:"Please try again after some time",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 18:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}();return(0,z.jsxs)(u.az,{display:"flex",width:"100%",justifyContent:"start",alignItems:"center",flexDir:"column",overflowY:"auto",background:"white",p:"6",children:[" ",(0,z.jsx)(w.A,{}),(0,z.jsx)(l.D,{mb:"6",children:"World Samma Federation"}),(0,z.jsx)(l.D,{size:"sm",mb:"6",children:"Admin Work Slot"}),(0,z.jsxs)(u.az,{display:"flex",justifyContent:"center",alignItems:"center",flexDir:"column",width:"100%",children:[" ",(0,z.jsxs)(d.E,{textAlign:"center",fontSize:"sm",fontWeight:500,bg:(0,p.dU)("green.50","green.900"),p:2,width:{base:"100%",md:"60%"},color:"green.500",rounded:"full",children:[D.length," submissions."]})]}),(0,z.jsxs)(u.az,{overflow:"auto",children:[0===D.length&&(0,z.jsx)(d.E,{children:"Work will be posted here."}),D.length>0&&D.map((function(e){return(0,z.jsxs)(h.T,{m:3,spacing:4,children:[(0,z.jsxs)(u.az,{display:"flex",justifyContent:"center",alignItems:"center",ml:2,width:"100%",children:[e.coachAssisted&&(0,z.jsx)(d.E,{fontSize:"sm",fontWeight:500,bg:(0,p.dU)("green.50","green.900"),px:6,p:"3",m:1,color:"green.500",rounded:"full",children:"Coach's assisted student rank upgrading"}),(0,z.jsx)(f._,{src:e.passport,alt:"Passport",width:"100",height:"100"}),(0,z.jsxs)(u.az,{justifyContent:"start",ml:2,textAlign:"start",children:[(0,z.jsxs)(l.D,{size:"md",children:["Name: ",e.student.name," ",e.student.otherName]}),(0,z.jsxs)(d.E,{children:["Admission: ",e.student.admission]}),(0,z.jsxs)(d.E,{children:["Current Rank: ",e.student.belt]})]})]})," ",(0,z.jsx)(u.az,{children:(0,z.jsx)("video",{controls:!0,width:"300",height:"200",children:(0,z.jsx)("source",{src:e.video,type:"video/mp4"})})}),(0,z.jsxs)(u.az,{display:"flex",width:{base:"90%",md:"60%"},justifyContent:"space-between",children:[" ",(0,z.jsx)(m.$,{isDisabled:P,onClick:function(){B(!0)},colorScheme:"green",children:"Approve"}),(0,z.jsxs)(m.$,{isDisabled:M||e.coachAssisted,onClick:function(){T(!0)},colorScheme:"red",children:[X&&(0,z.jsx)(x.y,{size:"sm"}),"Reject"]})]}),P&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(g.T,{placeholder:"Please leave a message for student...",value:oe,onChange:function(e){return ce(e.target.value)}}),(0,z.jsx)(m.$,{onClick:function(){fe(),pe(e._id,e.passport,e.video),se(e.student._id)},children:"Send Message"})]}),M&&(0,z.jsxs)(z.Fragment,{children:[" ",(0,z.jsxs)(j.MJ,{isInvalid:!O,children:[(0,z.jsx)(v.l,{children:"Certificate"}),(0,z.jsx)(A.p,{type:"file",accept:"application/pdf",onChange:function(e){return U(e.target.files[0])}}),q&&(0,z.jsx)("p",{children:"Uploading passport photo..."}),(0,z.jsx)(b.Wt,{children:"Please select a certificate."})]}),(0,z.jsx)(m.$,{onClick:function(){!function(){O||ue({title:"Select a certificate please.",status:"info"}),G(!0);var e=new FormData;e.append("file",O),e.append("upload_preset","worldsamma"),fetch("https://api.cloudinary.com/v1_1/dsdlgmgwi/image/upload",{method:"post",body:e}).then((function(e){return e.json()})).then((function(e){L(e.url),G(!1)})).catch((function(e){G(!1),ue({title:"Error Occurred uploading your passport photo.",description:"Please try again later.",duration:5e3,status:"error"})}))}(),pe(e._id,e.passport,e.video),se(e.student._id)},children:"Submit"})]})]},e._id)}))]})]})}},25695:function(e,t,n){n.d(t,{T:function(){return m}});var r=n(89379),s=n(80045),a=n(24765),i=n(14617),o=n(23226),c=n(73761),u=n(36254),l=n(14550),d=n(89254),p=n(70579),h=["className","rows"];var f=["h","minH","height","minHeight"],m=(0,o.R)((function(e,t){var n=(0,c.Vl)("Textarea",e),o=(0,u.MN)(e),m=o.className,x=o.rows,g=(0,s.A)(o,h),j=(0,i.t)(g),v=x?function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Object.assign({},e),s=(0,a.A)(n);try{for(s.s();!(t=s.n()).done;){var i=t.value;i in r&&delete r[i]}}catch(o){s.e(o)}finally{s.f()}return r}(n,f):n;return(0,p.jsx)(l.B.textarea,(0,r.A)((0,r.A)({ref:t,rows:x},j),{},{className:(0,d.cx)("chakra-textarea",m),__css:v}))}));m.displayName="Textarea"}}]);
//# sourceMappingURL=357.f8f3a3a5.chunk.js.map