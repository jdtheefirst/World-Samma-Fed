"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[42],{35042:function(e,n,o){o.r(n);var r=o(90675),c=o(10467),t=o(5544),s=o(65043),u=o(60184),i=o(51064),a=o(70579);n.default=function(){var e=(0,s.useState)(null),n=(0,t.A)(e,2),o=n[0],l=n[1],d=(0,s.useState)(null),f=(0,t.A)(d,2),g=f[0],p=f[1],v=(0,s.useState)(!1),b=(0,t.A)(v,2),m=b[0],h=b[1],S=(0,s.useState)(!1),k=(0,t.A)(S,2),j=k[0],x=k[1],w=(0,s.useState)(!1),W=(0,t.A)(w,2),N=W[0],P=W[1],R=(0,s.useRef)(null),A=(0,s.useRef)(null),C=(0,s.useRef)(null),T=new WebSocket("ws://167.99.44.195/ws/");T.onopen=function(){return console.log("WebSocket connected to ip")},T.onerror=function(e){return console.error("WebSocket error ip",e)},T.onclose=function(){return console.log("WebSocket closed ip")};var M=new WebSocket("ws://172.18.0.2:8188");M.onopen=function(){return console.log("WebSocket connected to IP 172")},M.onerror=function(e){return console.error("WebSocket error on IP 172",e)},M.onclose=function(){return console.log("WebSocket closed on IP 172")},(0,s.useEffect)((function(){return C.current||(C.current=new WebSocket("/ws/"),C.current.onopen=function(){P(!0),console.log("WebSocket connected to Janus")},C.current.onclose=function(){P(!1),console.log("WebSocket closed Janus connection")},C.current.onerror=function(e){console.error("WebSocket error",e)}),function(){C.current&&C.current.close()}}),[]),(0,s.useEffect)((function(){return N&&i.A.init({debug:"all",callback:function(){var e=new i.A({server:"/ws/",success:function(){E(e)},error:function(e){console.error("Janus error:",e)}});l(e)}}),function(){o&&o.destroy()}}),[N]);var E=function(e){e.attach({plugin:"janus.plugin.rtmp",success:function(e){p(e),console.log("RTMP plugin attached!"),y()},error:function(e){console.error("Error attaching RTMP plugin:",e)},webrtcState:function(e){x(e),console.log("WebRTC peer connection is ",e?"up":"down")},onmessage:function(e,n){console.log("Message received from RTMP plugin:",e)},onlocalstream:function(e){R.current.srcObject=e}})},y=function(){var e=(0,c.A)((0,r.A)().mark((function e(){var n;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:n=e.sent,R.current.srcObject=n,A.current=n,g&&g.createOffer({media:{video:!0,audio:!0,data:!1},stream:A.current,success:function(e){g.send({message:{request:"configure",audio:!0,video:!0},jsep:e})},error:function(e){console.error("Error creating WebRTC offer:",e)}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error accessing user media:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return(0,a.jsxs)("div",{className:"streaming-container",children:[(0,a.jsxs)("div",{className:"video-wrapper",children:[(0,a.jsx)("video",{ref:R,autoPlay:!0,muted:!0,className:"video-feed"}),!j&&(0,a.jsx)("div",{className:"overlay",children:"Connecting..."})]}),(0,a.jsxs)("div",{className:"control-panel",children:[(0,a.jsx)("h2",{children:"Live Stream Control"}),(0,a.jsxs)("div",{className:"status-indicators",children:[(0,a.jsx)("div",{className:"status ".concat(j?"connected":"disconnected"),children:j?"Connected":"Disconnected"}),(0,a.jsx)("div",{className:"status ".concat(m?"live":"idle"),children:m?"Live":"Idle"})]}),(0,a.jsxs)("div",{className:"controls",children:[(0,a.jsxs)("button",{onClick:function(){if(g){g.send({message:{request:"publish",rtmp_url:"rtmp://nginx/stream"},success:function(){console.log("Publishing to RTMP successfully!"),h(!0)},error:function(e){console.error("Error publishing to RTMP:",e)}})}else console.error("RTMP plugin not attached.")},disabled:m,className:"start-btn",children:[(0,a.jsx)(u.gSK,{})," Start Streaming"]}),(0,a.jsxs)("button",{onClick:function(){g&&(g.hangup(),h(!1),A.current&&A.current.getTracks().forEach((function(e){return e.stop()})))},disabled:!m,className:"stop-btn",children:[(0,a.jsx)(u.wFo,{})," Stop Streaming"]})]})]})]})}}}]);
//# sourceMappingURL=42.96af1231.chunk.js.map