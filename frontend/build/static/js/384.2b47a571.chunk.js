"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[384],{53747:function(e,n,t){t.d(n,{ZU:function(){return p},bK:function(){return d},tJ:function(){return f},uS:function(){return m}});var r=t(90675),o=t(5544),a=t(10467),c=t(79722),s=t(65043),i=t(42104),u=t(97665),f=u.z.object({name:u.z.string().min(2,"Name must be at least 2 characters").max(50,"Name must be at most 50 characters"),otherName:u.z.string().min(2,"Other name must be at least 2 characters").max(50,"Other name must be at most 50 characters"),email:u.z.string().email("Invalid email address"),gender:u.z.enum(["male","female","other"]),password:u.z.string().min(4,"Password must be at least 8 characters long").max(100,"Password must be at most 100 characters"),confirmPassword:u.z.string().min(4,"Confirm password must be at least 8 characters long").max(100,"Confirm password must be at most 100 characters").refine((function(e,n){return e===n.parent.password}),{message:"Passwords do not match"}),passport:u.z.string().regex(/^\d{8,15}$/,"Invalid passport/ID number"),selectedCountry:u.z.string().min(2,"Country is required"),provinces:u.z.string().optional(),language:u.z.string().min(2,"Language is required"),pic:u.z.string().url("Profile picture is required")});function d(e){var n=(0,s.useState)(null),t=(0,o.A)(n,2),r=t[0],a=t[1],c=(0,s.useRef)(null);return(0,s.useEffect)((function(){if(e&&e.token){if(!c.current){var n=e._id,t=(0,i.io)("/",{query:{token:e.token,userId:n}});return t.on("connect",(function(){console.log("connected"),a(t)})),t.on("disconnect",(function(e){console.log("Socket.IO disconnected due to:",e),"io server disconnect"===e&&t.connect()})),t.on("reconnect_attempt",(function(e){console.log("Reconnection attempt ".concat(e))})),t.on("error",(function(e){console.error("Socket.IO error:",e)})),c.current=t,function(){t&&t.disconnect(),c.current=null}}a(c.current)}}),[e]),r}function p(e,n,t,r){return l.apply(this,arguments)}function l(){return(l=(0,a.A)((0,r.A)().mark((function e(n,t,o,a){var s,i;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,s={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(o.token)}},e.next=6,c.A.post("/api/paycheck/makepaymentmpesa/".concat(o._id,"?amount=").concat(n),{phoneNumber:t},s);case 6:i=e.sent,i.data&&a({title:"You have been prompt to finish your subscription process",status:"info",duration:1e3,position:"bottom"}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}function m(e,n,t){return h.apply(this,arguments)}function h(){return(h=(0,a.A)((0,r.A)().mark((function e(n,t,o){var a,s;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,a={headers:{"Content-type":"application/json"}},e.next=6,c.A.post("/api/paycheck/donationsmpesa?amount=".concat(n),{phoneNumber:t},a);case 6:s=e.sent,s.data&&o({title:"You have been prompt to finish your subscription process",status:"info",duration:1e3,position:"bottom"}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}},36384:function(e,n,t){t.r(n);var r=t(5544),o=t(65043),a=t(22107),c=t(39081),s=t(56818),i=t(53747),u=t(51684),f=t(70579);n.default=function(){var e=(0,o.useState)(!1),n=(0,r.A)(e,2),t=n[0],d=n[1],p=(0,o.useRef)(null),l=(0,o.useRef)(null),m=(0,s.a)().user,h=(0,i.bK)(m),v=(0,o.useState)(!1),b=(0,r.A)(v,2),g=b[0],k=b[1];(0,o.useEffect)((function(){h&&(k(h.connected),h.on("connect",(function(){return k(!0)})),h.on("disconnect",(function(){return k(!1)})))}),[h]),(0,o.useEffect)((function(){if(g)return h.emit("checkLiveStream"),h.on("liveStreamStatus",(function(e){d(e),e&&w()})),h.on("streamEnded",(function(){d(!1)})),h.on("stopped",(function(e){d(e),p.current&&(p.current.dispose(),p.current=null)})),function(){h.off("liveStreamStatus"),h.off("stopped"),h.off("streamEnded"),p.current&&(p.current.dispose(),p.current=null)}}),[g]);var w=function(){if(l.current){var e={remoteVideo:l.current,onicecandidate:function(e){e&&h.emit("onUserIceCandidate",e)}},n=u.G.WebRtcPeerRecvonly(e,(function(e){if(e)return console.error("WebRTC peer creation failed:",e);this.generateOffer((function(e,n){if(e)return console.error("Error generating SDP offer:",e);h.emit("joinStream",{sdpOffer:n})}))}));p.current=n,h.on("userSdpAnswer",(function(e){var n=e.sdpAnswer;p.current&&p.current.processAnswer(n,(function(e){e&&console.error("Error processing SDP answer:",e)}))})),h.on("userIceCandidate",(function(e){p.current&&e&&p.current.addIceCandidate(e,(function(e){e&&console.error("Error adding ICE candidate:",e)}))}))}};return t?(0,f.jsxs)(a.a,{children:[(0,f.jsx)(c.E,{children:"Live Stream"}),(0,f.jsx)("video",{ref:l,autoPlay:!0,style:{width:"100%",height:"80vh"}})]}):(0,f.jsx)(a.a,{children:(0,f.jsx)(c.E,{children:"No live stream is currently active."})})}}}]);
//# sourceMappingURL=384.2b47a571.chunk.js.map