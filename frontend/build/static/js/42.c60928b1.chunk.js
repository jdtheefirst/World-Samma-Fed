"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[42],{35042:function(e,n,r){r.r(n);var t=r(90675),o=r(10467),c=r(5544),s=r(65043),i=r(60184),a=r(27787),u=r.n(a),l=(r(44050),r(58650),r(70579));n.default=function(){var e=(0,s.useRef)(null),n=(0,s.useState)(null),r=(0,c.A)(n,2),a=r[0],d=r[1],f=(0,s.useState)(!1),h=(0,c.A)(f,2),g=h[0],m=h[1],p=(0,s.useState)(!1),v=(0,c.A)(p,2),j=v[0],b=v[1],x=(0,s.useRef)(null),S=(0,s.useRef)(null),C=(0,s.useRef)(null);(0,s.useEffect)((function(){return y(),function(){R()}}),[]);var y=function(){var n=(0,o.A)((0,t.A)().mark((function n(){var r;return(0,t.A)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{r=new(u().Client)("/ws/",{keepalive:!0}),e.current=r,r.createConnection("id").then((function(e){e.createSession().then((function(e){e.attachPlugin("janus.plugin.rtmp").then((function(e){console.log("RTMP plugin attached!"),d(e),b(!0),N(e)})).catch((function(e){console.error("Plugin attach error:",e)}))})).catch((function(e){console.error("Session creation error:",e)}))})).catch((function(e){console.error("Connection creation error:",e)}))}catch(t){console.error("Error initializing Janus:",t)}case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),N=function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(n){x.current.srcObject=n,S.current=n,e.createOffer({media:{video:!0,audio:!0},stream:n,success:function(n){e.send({message:{request:"configure",audio:!0,video:!0},jsep:n})},error:function(e){return console.error("Error creating WebRTC offer:",e)}})})).catch((function(e){console.error("Error accessing user media:",e)})),e.on("message",(function(e){console.log("Message received from RTMP plugin:",e)})),e.on("localstream",(function(e){console.log("Local stream attached."),x.current.srcObject=e,S.current=e})),e.on("webrtcState",(function(e){console.log("WebRTC peer connection is",e?"up":"down")}))},R=function(){e.current&&"function"===typeof e.current.destroy?(e.current.destroy(),console.log("Janus destroyed successfully")):console.error("Janus instance not found or destroy method missing"),C.current&&(C.current.close(),console.log("WebSocket connection closed"))};return(0,l.jsxs)("div",{className:"streaming-container",children:[(0,l.jsxs)("div",{className:"video-wrapper",children:[(0,l.jsx)("video",{ref:x,autoPlay:!0,muted:!0,className:"video-feed"}),!j&&(0,l.jsx)("div",{className:"overlay",children:"Connecting..."})]}),(0,l.jsxs)("div",{className:"control-panel",children:[(0,l.jsx)("h2",{children:"Live Stream Control"}),(0,l.jsxs)("div",{className:"status-indicators",children:[(0,l.jsx)("div",{className:"status ".concat(j?"connected":"disconnected"),children:j?"Connected":"Disconnected"}),(0,l.jsx)("div",{className:"status ".concat(g?"live":"idle"),children:g?"Live":"Idle"})]}),(0,l.jsxs)("div",{className:"controls",children:[(0,l.jsxs)("button",{onClick:function(){if(a){a.send({message:{request:"publish",rtmp_url:"/stream"},success:function(){console.log("Publishing to RTMP successfully!"),m(!0)},error:function(e){return console.error("Error publishing to RTMP:",e)}})}else console.error("RTMP plugin not attached.")},disabled:g||!j,className:"start-btn",children:[(0,l.jsx)(i.gSK,{})," Start Streaming"]}),(0,l.jsxs)("button",{onClick:function(){a&&(a.hangup(),m(!1),S.current&&S.current.getTracks().forEach((function(e){return e.stop()})))},disabled:!g,className:"stop-btn",children:[(0,l.jsx)(i.wFo,{})," Stop Streaming"]})]})]})]})}}}]);
//# sourceMappingURL=42.c60928b1.chunk.js.map