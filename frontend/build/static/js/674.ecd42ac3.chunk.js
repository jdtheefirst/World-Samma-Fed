/*! For license information please see 674.ecd42ac3.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[674],{51064:function(e,r,t){t.d(r,{A:function(){return c}});var n=t(90675),a=t(10467),o=t(5544),i=t(24765);e=t.hmd(e);var c=function(r){if("function"===typeof define&&t.amdO)define(r);else if(e.exports)e.exports=r();else if("object"===typeof window)return r()}((function(){r.sessions=new Map,r.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||r.extension.isInstalled()}return!0};var e={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var r=window.setTimeout((function(){var r=new Error("NavigatorUserMediaError");return r.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(r)}),1e3);this.cache[r]=e,window.postMessage({type:"janusGetScreen",id:r},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(r){if(r.origin==window.location.origin)if("janusGotScreen"==r.data.type&&e[r.data.id]){var t=e[r.data.id];if(delete e[r.data.id],""===r.data.sourceId){var n=new Error("NavigatorUserMediaError");n.name="You cancelled the request for permission, giving up...",t(n)}else t(null,r.data.sourceId)}else"janusGetScreenPending"==r.data.type&&window.clearTimeout(r.data.id)}))}};function r(e){if((e=e||{}).success="function"==typeof e.success?e.success:r.noop,e.error="function"==typeof e.error?e.error:r.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:r.noop,!r.initDone)return e.error("Library not initialized"),{};if(!r.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(r.log("Library initialized: "+r.initDone),!e.server)return e.error("Invalid server url"),{};var t=!1,o=null,c={},s=null,d=null,u=0,l=e.server;r.isArray(l)?(r.log("Multiple servers provided ("+l.length+"), will use the first that works"),l=null,d=e.server,r.debug(d)):0===l.indexOf("ws")?(t=!0,r.log("Using WebSockets to contact Janus: "+l)):(t=!1,r.log("Using REST API to contact Janus: "+l));var f=e.iceServers||[{urls:"stun:stun.l.google.com:19302"}],p=e.iceTransportPolicy,v=e.bundlePolicy,g=!1;"undefined"!==typeof e.withCredentials&&null!==e.withCredentials&&(g=!0===e.withCredentials);var m=10;"undefined"!==typeof e.max_poll_events&&null!==e.max_poll_events&&(m=e.max_poll_events),m<1&&(m=1);var h=null;"undefined"!==typeof e.token&&null!==e.token&&(h=e.token);var b=null;"undefined"!==typeof e.apisecret&&null!==e.apisecret&&(b=e.apisecret),this.destroyOnUnload=!0,"undefined"!==typeof e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var y=25e3;"undefined"!==typeof e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(y=e.keepAlivePeriod),isNaN(y)&&(y=25e3);var w=6e4;function k(e){var r={high:9e5,medium:3e5,low:1e5};return"undefined"!==typeof e&&null!==e&&(e.high&&(r.high=e.high),e.medium&&(r.medium=e.medium),e.low&&(r.low=e.low)),r}"undefined"!==typeof e.longPollTimeout&&null!==e.longPollTimeout&&(w=e.longPollTimeout),isNaN(w)&&(w=6e4);var S=!1,T=null,C=new Map,x=this,A=0,I=new Map;function O(){if(null!=T)if(r.debug("Long poll..."),S){var t=l+"/"+T+"?rid="+(new Date).getTime();m&&(t=t+"&maxev="+m),h&&(t=t+"&token="+encodeURIComponent(h)),b&&(t=t+"&apisecret="+encodeURIComponent(b)),r.httpAPICall(t,{verb:"GET",withCredentials:g,success:R,timeout:w,error:function(t,n){if(r.error(t+":",n),++A>3)return S=!1,void e.error("Lost connection to the server (is it down?)");O()}})}else r.warn("Is the server down? (connected=false)")}function R(e,n){if(A=0,t||"undefined"===typeof T||null===T||!0===n||O(),t||!r.isArray(e))if("keepalive"!==e.janus)if("server_info"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus)if("trickle"===e.janus){var a=e.sender;if(!a)return void r.warn("Missing sender...");var i=C.get(a);if(!i)return void r.debug("This handle is not attached to this session");var c=e.candidate;r.debug("Got a trickled candidate on session "+T),r.debug(c);var s=i.webrtcStuff;s.pc&&s.remoteSdp?(r.debug("Adding remote candidate:",c),c&&!0!==c.completed?s.pc.addIceCandidate(c):s.pc.addIceCandidate(r.endOfCandidates)):(r.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),s.candidates||(s.candidates=[]),s.candidates.push(c),r.debug(s.candidates))}else{if("webrtcup"===e.janus){r.debug("Got a webrtcup event on session "+T),r.debug(e);var d=e.sender;if(!d)return void r.warn("Missing sender...");var u=C.get(d);return u?void u.webrtcState(!0):void r.debug("This handle is not attached to this session")}if("hangup"===e.janus){r.debug("Got a hangup event on session "+T),r.debug(e);var l=e.sender;if(!l)return void r.warn("Missing sender...");var f=C.get(l);if(!f)return void r.debug("This handle is not attached to this session");f.webrtcState(!1,e.reason),f.hangup()}else if("detached"===e.janus){r.debug("Got a detached event on session "+T),r.debug(e);var p=e.sender;if(!p)return void r.warn("Missing sender...");var v=C.get(p);if(!v)return;v.ondetached(),v.detach()}else if("media"===e.janus){r.debug("Got a media event on session "+T),r.debug(e);var g=e.sender;if(!g)return void r.warn("Missing sender...");var m=C.get(g);if(!m)return void r.debug("This handle is not attached to this session");m.mediaState(e.type,e.receiving,e.mid)}else if("slowlink"===e.janus){r.debug("Got a slowlink event on session "+T),r.debug(e);var h=e.sender;if(!h)return void r.warn("Missing sender...");var b=C.get(h);if(!b)return void r.debug("This handle is not attached to this session");b.slowLink(e.uplink,e.lost,e.mid)}else{if("error"===e.janus){r.error("Ooops: "+e.error.code+" "+e.error.reason),r.debug(e);var y=e.transaction;if(y){var w=I.get(y);w&&w(e),I.delete(y)}return}if("event"===e.janus){r.debug("Got a plugin event on session "+T),r.debug(e);var k=e.sender;if(!k)return void r.warn("Missing sender...");var S=e.plugindata;if(!S)return void r.warn("Missing plugindata...");r.debug("  -- Event is coming from "+k+" ("+S.plugin+")");var x=S.data;r.debug(x);var P=C.get(k);if(!P)return void r.warn("This handle is not attached to this session");var E=e.jsep;E&&(r.debug("Handling SDP as well..."),r.debug(E));var j=P.onmessage;j?(r.debug("Notifying application..."),j(x,E)):r.debug("No provided notification callback")}else{if("timeout"===e.janus)return r.error("Timeout on session "+T),r.debug(e),void(t&&o.close(3504,"Gateway timeout"));r.warn("Unknown message/event  '"+e.janus+"' on session "+T),r.debug(e)}}}else{r.debug("Got a success on session "+T),r.debug(e);var D=e.transaction;if(D){var L=I.get(D);L&&L(e),I.delete(D)}}else{r.debug("Got an ack on session "+T),r.debug(e);var N=e.transaction;if(N){var M=I.get(N);M&&M(e),I.delete(N)}}else{r.debug("Got info on the Janus instance"),r.debug(e);var V=e.transaction;if(V){var _=I.get(V);_&&_(e),I.delete(V)}}else r.vdebug("Got a keepalive on session "+T);else for(var G=0;G<e.length;G++)R(e[G],!0)}function P(){if(l&&t&&S){s=setTimeout(P,y);var e={janus:"keepalive",session_id:T,transaction:r.randomString(12)};h&&(e.token=h),b&&(e.apisecret=b),o.send(JSON.stringify(e))}}function E(n){var a=r.randomString(12),i={janus:"create",transaction:a};if(n.reconnect&&(S=!1,i.janus="claim",i.session_id=T,o&&(o.onopen=null,o.onerror=null,o.onclose=null,s&&(clearTimeout(s),s=null))),h&&(i.token=h),b&&(i.apisecret=b),!l&&r.isArray(d)&&(0===(l=d[u]).indexOf("ws")?(t=!0,r.log("Server #"+(u+1)+": trying WebSockets to contact Janus ("+l+")")):(t=!1,r.log("Server #"+(u+1)+": trying REST API to contact Janus ("+l+")"))),t)for(var f in o=r.newWebSocket(l,"janus-protocol"),c={error:function(){if(r.error("Error connecting to the Janus WebSockets server... "+l),r.isArray(d)&&!n.reconnect)return++u===d.length?void n.error("Error connecting to any of the provided Janus servers: Is the server down?"):(l=null,void setTimeout((function(){E(n)}),200));n.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){I.set(a,(function(e){if(r.debug(e),"success"!==e.janus)return r.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error(e.error.reason);s=setTimeout(P,y),S=!0,T=e.session_id?e.session_id:e.data.id,n.reconnect?r.log("Claimed session: "+T):r.log("Created session: "+T),r.sessions.set(T,x),n.success()})),o.send(JSON.stringify(i))},message:function(e){R(JSON.parse(e.data))},close:function(){l&&S&&(S=!1,e.error("Lost connection to the server (is it down?)"))}})o.addEventListener(f,c[f]);else r.httpAPICall(l,{verb:"POST",withCredentials:g,body:i,success:function(e){if(r.debug(e),"success"!==e.janus)return r.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error(e.error.reason);S=!0,T=e.session_id?e.session_id:e.data.id,n.reconnect?r.log("Claimed session: "+T):r.log("Created session: "+T),r.sessions.set(T,x),O(),n.success()},error:function(e,t){if(r.error(e+":",t),r.isArray(d)&&!n.reconnect)return++u===d.length?void n.error("Error connecting to any of the provided Janus servers: Is the server down?"):(l=null,void setTimeout((function(){E(n)}),200));""===t?n.error(e+": Is the server down?"):t&&t.error?n.error(e+": "+t.error.message):n.error(e+": "+t)}})}function j(e,n){if((n=n||{}).success="function"==typeof n.success?n.success:r.noop,n.error="function"==typeof n.error?n.error:r.noop,!S)return r.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var a=C.get(e);if(!a||!a.webrtcStuff)return r.warn("Invalid handle"),void n.error("Invalid handle");var i=n.message,c=n.jsep,s=r.randomString(12),d={janus:"message",body:i,transaction:s};if(a.token&&(d.token=a.token),b&&(d.apisecret=b),c){d.jsep={type:c.type,sdp:c.sdp},c.e2ee&&(d.jsep.e2ee=!0),"hml"!==c.rid_order&&"lmh"!==c.rid_order||(d.jsep.rid_order=c.rid_order),c.force_relay&&(d.jsep.force_relay=!0);var u=null,f=a.webrtcStuff;if(f.pc){var p=f.pc.getTransceivers();if(p&&p.length>0)for(var v in p){var m=p[v];if(m&&m.sender&&m.sender.track&&"video"===m.sender.track.kind){var h=m.sender.getParameters();h&&h.encodings&&h.encodings[0]&&h.encodings[0].scalabilityMode&&(u||(u=[]),u.push({mindex:parseInt(v),mid:m.mid,svc:h.encodings[0].scalabilityMode}))}}}u&&(d.jsep.svc=u)}if(r.debug("Sending message to plugin (handle="+e+"):"),r.debug(d),t)return d.session_id=T,d.handle_id=e,I.set(s,(function(e){if(r.debug("Message sent!"),r.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return r.warn("Request succeeded, but missing plugindata..."),void n.success();r.log("Synchronous transaction successful ("+t.plugin+")");var a=t.data;return r.debug(a),void n.success(a)}"ack"===e.janus?n.success():e.error?(r.error("Ooops: "+e.error.code+" "+e.error.reason),n.error(e.error.code+" "+e.error.reason)):(r.error("Unknown error"),n.error("Unknown error"))})),void o.send(JSON.stringify(d));r.httpAPICall(l+"/"+T+"/"+e,{verb:"POST",withCredentials:g,body:d,success:function(e){if(r.debug("Message sent!"),r.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return r.warn("Request succeeded, but missing plugindata..."),void n.success();r.log("Synchronous transaction successful ("+t.plugin+")");var a=t.data;return r.debug(a),void n.success(a)}"ack"===e.janus?n.success():e.error?(r.error("Ooops: "+e.error.code+" "+e.error.reason),n.error(e.error.code+" "+e.error.reason)):(r.error("Unknown error"),n.error("Unknown error"))},error:function(e,t){r.error(e+":",t),n.error(e+": "+t)}})}function D(e,n){if(S){var a=C.get(e);if(a&&a.webrtcStuff){var i={janus:"trickle",candidate:n,transaction:r.randomString(12)};if(a.token&&(i.token=a.token),b&&(i.apisecret=b),r.vdebug("Sending trickle candidate (handle="+e+"):"),r.vdebug(i),t)return i.session_id=T,i.handle_id=e,void o.send(JSON.stringify(i));r.httpAPICall(l+"/"+T+"/"+e,{verb:"POST",withCredentials:g,body:i,success:function(e){r.vdebug("Candidate sent!"),r.vdebug(e),"ack"===e.janus||r.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,t){r.error(e+":",t)}})}else r.warn("Invalid handle")}else r.warn("Is the server down? (connected=false)")}function L(e,t,n,a,o){var c=C.get(e);if(c&&c.webrtcStuff){var s=c.webrtcStuff;if(s.pc){var d=function(e){r.log("Received state change on data channel:",e);var t=e.target.label,n=e.target.protocol,a=s.dataChannel[t]?s.dataChannel[t].readyState:"null";if(r.log("State change on <"+t+"> data channel: "+a),"open"===a){if(s.dataChannel[t].pending&&s.dataChannel[t].pending.length>0){r.log("Sending pending messages on <"+t+">:",s.dataChannel[t].pending.length);var o,d=(0,i.A)(s.dataChannel[t].pending);try{for(d.s();!(o=d.n()).done;){var u=o.value;r.log("Sending data on data channel <"+t+">"),r.debug(u),s.dataChannel[t].send(u)}}catch(l){d.e(l)}finally{d.f()}s.dataChannel[t].pending=[]}c.ondataopen(t,n)}};if(a)s.dataChannel[t]=a;else{var u=s.dataChannelOptions;n&&(u.protocol=n),s.dataChannel[t]=s.pc.createDataChannel(t,u)}s.dataChannel[t].onmessage=function(e){r.log("Received message on data channel:",e);var t=e.target.label;c.ondata(e.data,t)},s.dataChannel[t].onopen=d,s.dataChannel[t].onclose=d,s.dataChannel[t].onerror=function(e){r.error("Got error on data channel:",e)},s.dataChannel[t].pending=[],o&&s.dataChannel[t].pending.push(o)}else r.warn("Invalid PeerConnection")}else r.warn("Invalid handle")}function N(e,t){(t=t||{}).success="function"==typeof t.success?t.success:r.noop,t.error="function"==typeof t.error?t.error:r.noop;var n=C.get(e);if(!n||!n.webrtcStuff)return r.warn("Invalid handle"),void t.error("Invalid handle");var a=n.webrtcStuff,o=t.text||t.data;if(!o)return r.warn("Invalid data"),void t.error("Invalid data");var i=t.label?t.label:r.dataChanDefaultLabel;return a.dataChannel[i]?"open"!==a.dataChannel[i].readyState?(a.dataChannel[i].pending.push(o),void t.success()):(r.log("Sending data on data channel <"+i+">"),r.debug(o),a.dataChannel[i].send(o),void t.success()):(L(e,i,t.protocol,!1,o,t.protocol),void t.success())}function M(e,t){(t=t||{}).success="function"==typeof t.success?t.success:r.noop,t.error="function"==typeof t.error?t.error:r.noop;var n=C.get(e);if(!n||!n.webrtcStuff)return r.warn("Invalid handle"),void t.error("Invalid handle");var a=n.webrtcStuff;if(!a.dtmfSender){if(a.pc){var o=a.pc.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));if(!o)return r.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");a.dtmfSender=o.dtmf,a.dtmfSender&&(r.log("Created DTMF Sender"),a.dtmfSender.ontonechange=function(e){r.debug("Sent DTMF tone: "+e.tone)})}if(!a.dtmfSender)return r.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var i=t.dtmf;if(!i)return r.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var c=i.tones;if(!c)return r.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var s="number"===typeof i.duration?i.duration:500,d="number"===typeof i.gap?i.gap:50;r.debug("Sending DTMF string "+c+" (duration "+s+"ms, gap "+d+"ms)"),a.dtmfSender.insertDTMF(c,s,d),t.success()}function V(e,n){(n=n||{}).success="function"==typeof n.success?n.success:r.noop,n.error="function"==typeof n.error?n.error:r.noop;var a=!0===n.noRequest;r.log("Destroying handle "+e+" (only-locally="+a+")"),ae(e);var i=C.get(e);if(!i||i.detached)return C.delete(e),void n.success();if(i.detached=!0,a)return C.delete(e),void n.success();if(!S)return r.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var c={janus:"detach",transaction:r.randomString(12)};if(i.token&&(c.token=i.token),b&&(c.apisecret=b),t)return c.session_id=T,c.handle_id=e,o.send(JSON.stringify(c)),C.delete(e),void n.success();r.httpAPICall(l+"/"+T+"/"+e,{verb:"POST",withCredentials:g,body:c,success:function(t){r.log("Destroyed handle:"),r.debug(t),"success"!==t.janus&&r.error("Ooops: "+t.error.code+" "+t.error.reason),C.delete(e),n.success()},error:function(t,a){r.error(t+":",a),C.delete(e),n.success()}})}function _(e,t){var n=C.get(e);if(!n||!n.webrtcStuff)throw r.warn("Invalid handle"),"Invalid handle";var a=n.webrtcStuff;if(!a.pc){var o={iceServers:f,iceTransportPolicy:p,bundlePolicy:v,sdpSemantics:"unified-plan"},c=!1;if(t.tracks){var s,d=(0,i.A)(t.tracks);try{for(d.s();!(s=d.n()).done;){var u=s.value;if(u.transforms&&(u.transforms.sender||u.transforms.receiver)){c=!0;break}}}catch(l){d.e(l)}finally{d.f()}}t.externalEncryption&&(c=!0,a.externalEncryption=!0),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&c&&(a.insertableStreams=!0,o.forceEncodedAudioInsertableStreams=!0,o.forceEncodedVideoInsertableStreams=!0,o.encodedInsertableStreams=!0),r.log("Creating PeerConnection"),a.pc=new RTCPeerConnection(o),r.debug(a.pc),a.pc.getStats&&(a.volume={},a.bitrate.value="0 kbits/sec"),r.log("Preparing local SDP and gathering candidates (trickle="+a.trickle+")"),a.pc.onconnectionstatechange=function(){a.pc&&n.connectionState(a.pc.connectionState)},a.pc.oniceconnectionstatechange=function(){a.pc&&n.iceState(a.pc.iceConnectionState)},a.pc.onicecandidate=function(n){if(!n.candidate||n.candidate.candidate&&n.candidate.candidate.indexOf("endOfCandidates")>0)r.log("End of candidates."),a.iceDone=!0,!0===a.trickle?D(e,{completed:!0}):function(e,t){t=t||{},t.success="function"==typeof t.success?t.success:r.noop,t.error="function"==typeof t.error?t.error:r.noop;var n=C.get(e);if(!n||!n.webrtcStuff)return void r.warn("Invalid handle, not sending anything");var a=n.webrtcStuff;if(r.log("Sending offer/answer SDP..."),!a.mySdp)return void r.warn("Local SDP instance is invalid, not sending anything...");a.mySdp={type:a.pc.localDescription.type,sdp:a.pc.localDescription.sdp},!1===a.trickle&&(a.mySdp.trickle=!1);r.debug(t),a.sdpSent=!0,t.success(a.mySdp)}(e,t);else{var o={candidate:n.candidate.candidate,sdpMid:n.candidate.sdpMid,sdpMLineIndex:n.candidate.sdpMLineIndex};!0===a.trickle&&D(e,o)}},a.pc.ontrack=function(e){if(r.log("Handling Remote Track",e),e.streams&&e.track){var t=e.transceiver?e.transceiver.mid:e.track.id;try{e.transceiver&&e.transceiver.mid&&e.track.id&&(n.mids||(n.mids={}),n.mids[e.track.id]=e.transceiver.mid),n.onremotetrack(e.track,t,!0,{reason:"created"})}catch(i){r.error("Error calling onremotetrack",i)}if(!e.track.onended){var o=null;r.log("Adding onended callback to track:",e.track),e.track.onended=function(t){r.log("Remote track removed:",t),clearTimeout(o);var c=a.pc?a.pc.getTransceivers():null,s=c?c.find((function(e){return e.receiver.track===t.target})):null,d=s?s.mid:t.target.id;d===t.target.id&&n.mids&&n.mids[e.track.id]&&(d=n.mids[e.track.id]);try{n.onremotetrack(t.target,d,!1,{reason:"ended"})}catch(i){r.error("Error calling onremotetrack on removal",i)}delete n.mids[e.track.id]},e.track.onmute=function(t){r.log("Remote track muted:",t),o||(o=setTimeout((function(){r.log("Removing remote track");var c=a.pc?a.pc.getTransceivers():null,s=c?c.find((function(e){return e.receiver.track===t.target})):null,d=s?s.mid:t.target.id;d===t.target.id&&n.mids&&n.mids[e.track.id]&&(d=n.mids[e.track.id]);try{n.onremotetrack(t.target,d,!1,{reason:"mute"})}catch(i){r.error("Error calling onremotetrack on mute",i)}o=null}),2520))},e.track.onunmute=function(e){if(r.log("Remote track flowing again:",e),null!=o)clearTimeout(o),o=null;else try{var t=a.pc?a.pc.getTransceivers():null,c=t?t.find((function(r){return r.receiver.track===e.target})):null,s=c?c.mid:e.target.id;n.onremotetrack(e.target,s,!0,{reason:"unmute"})}catch(i){r.error("Error calling onremotetrack on unmute",i)}}}}}}}function G(e,r,t){return J.apply(this,arguments)}function J(){return(J=(0,a.A)((0,n.A)().mark((function e(t,a,o){var c,s,d,u,l,f,p,v,g,m;return(0,n.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=o||{}).success="function"==typeof o.success?o.success:r.noop,o.error="function"==typeof o.error?o.error:ne,c=o.jsep,!a||!c){e.next=10;break}return r.error("Provided a JSEP to a createOffer"),o.error("Provided a JSEP to a createOffer"),e.abrupt("return");case 10:if(a||c&&c.type&&c.sdp){e.next=14;break}return r.error("A valid JSEP is required for createAnswer"),o.error("A valid JSEP is required for createAnswer"),e.abrupt("return");case 14:if(!o.media||o.tracks){e.next=36;break}if(o.tracks=r.mediaToTracks(o.media),!0!==o.simulcast&&!0!==o.simulcast2&&!o.svc){e.next=35;break}s=(0,i.A)(o.tracks),e.prev=18,s.s();case 20:if((d=s.n()).done){e.next=27;break}if("video"!==(u=d.value).type){e.next=25;break}return!0===o.simulcast||!0===o.simulcast2?u.simulcast=!0:o.svc&&(u.svc=o.svc),e.abrupt("break",27);case 25:e.next=20;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(18),s.e(e.t0);case 32:return e.prev=32,s.f(),e.finish(32);case 35:r.warn("Deprecated media object passed, use tracks instead. Automatically translated to:",o.tracks);case 36:if(!o.tracks||Array.isArray(o.tracks)){e.next=40;break}return r.error("Tracks must be an array"),o.error("Tracks must be an array"),e.abrupt("return");case 40:if((l=C.get(t))&&l.webrtcStuff){e.next=45;break}return r.warn("Invalid handle"),o.error("Invalid handle"),e.abrupt("return");case 45:if((f=l.webrtcStuff).trickle=oe(o.trickle),e.prev=47,_(t,o),!a){e.next=52;break}return e.next=52,Y(t,o);case 52:if(c){e.next=59;break}return e.next=55,W(t,o);case 55:p=e.sent,o.success(p),e.next=70;break;case 59:return e.next=61,f.pc.setRemoteDescription(c);case 61:if(r.log("Remote description accepted!"),f.remoteSdp=c.sdp,f.candidates&&f.candidates.length>0){for(v=0;v<f.candidates.length;v++)g=f.candidates[v],r.debug("Adding remote candidate:",g),g&&!0!==g.completed?f.pc.addIceCandidate(g):f.pc.addIceCandidate(r.endOfCandidates);f.candidates=[]}return e.next=66,Y(t,o);case 66:return e.next=68,B(t,o);case 68:m=e.sent,o.success(m);case 70:e.next=76;break;case 72:e.prev=72,e.t1=e.catch(47),r.error(e.t1),o.error(e.t1);case 76:case"end":return e.stop()}}),e,null,[[18,29,32,35],[47,72]])})))).apply(this,arguments)}function F(e,t){(t=t||{}).success="function"==typeof t.success?t.success:r.noop,t.error="function"==typeof t.error?t.error:ne,t.customizeSdp="function"==typeof t.customizeSdp?t.customizeSdp:r.noop;var n=t.jsep,a=C.get(e);if(!a||!a.webrtcStuff)return r.warn("Invalid handle"),void t.error("Invalid handle");var o=a.webrtcStuff;if(n){if(!o.pc)return r.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");t.customizeSdp(n),o.pc.setRemoteDescription(n).then((function(){if(r.log("Remote description accepted!"),o.remoteSdp=n.sdp,o.candidates&&o.candidates.length>0){for(var e=0;e<o.candidates.length;e++){var a=o.candidates[e];r.debug("Adding remote candidate:",a),a&&!0!==a.completed?o.pc.addIceCandidate(a):o.pc.addIceCandidate(r.endOfCandidates)}o.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function W(e,r){return U.apply(this,arguments)}function U(){return(U=(0,a.A)((0,n.A)().mark((function e(t,a){var o,i,c,s,d;return(0,n.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=a||{}).customizeSdp="function"==typeof a.customizeSdp?a.customizeSdp:r.noop,(o=C.get(t))&&o.webrtcStuff){e.next=6;break}throw r.warn("Invalid handle"),"Invalid handle";case 6:return i=o.webrtcStuff,r.log("Creating offer (iceDone="+i.iceDone+")"),c={},!0===a.iceRestart&&(c.iceRestart=!0),r.debug(c),e.next=14,i.pc.createOffer(c);case 14:return s=e.sent,r.debug(s),d={type:"offer",sdp:s.sdp},a.customizeSdp(d),s.sdp=d.sdp,r.log("Setting local description"),i.mySdp={type:"offer",sdp:s.sdp},e.next=23,i.pc.setLocalDescription(s);case 23:if(i.mediaConstraints=c,i.iceDone||i.trickle){e.next=27;break}return r.log("Waiting for all candidates..."),e.abrupt("return",null);case 27:return(i.insertableStreams||i.externalEncryption)&&(s.e2ee=!0),e.abrupt("return",s);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,r){return z.apply(this,arguments)}function z(){return(z=(0,a.A)((0,n.A)().mark((function e(t,a){var o,i,c,s;return(0,n.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=a||{}).customizeSdp="function"==typeof a.customizeSdp?a.customizeSdp:r.noop,(o=C.get(t))&&o.webrtcStuff){e.next=6;break}throw r.warn("Invalid handle"),"Invalid handle";case 6:return i=o.webrtcStuff,r.log("Creating answer (iceDone="+i.iceDone+")"),e.next=10,i.pc.createAnswer();case 10:return c=e.sent,r.debug(c),s={type:"answer",sdp:c.sdp},a.customizeSdp(s),c.sdp=s.sdp,r.log("Setting local description"),i.mySdp={type:"answer",sdp:c.sdp},e.next=19,i.pc.setLocalDescription(c);case 19:if(i.iceDone||i.trickle){e.next=22;break}return r.log("Waiting for all candidates..."),e.abrupt("return",null);case 22:return(i.insertableStreams||i.externalEncryption)&&(c.e2ee=!0),e.abrupt("return",c);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,r){return H.apply(this,arguments)}function H(){return(H=(0,a.A)((0,n.A)().mark((function e(t,a){var o,c,s;return(0,n.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=a||{}).success="function"==typeof a.success?a.success:r.noop,a.error="function"==typeof a.error?a.error:r.noop,!a.tracks||Array.isArray(a.tracks)){e.next=7;break}return r.error("Tracks must be an array"),a.error("Tracks must be an array"),e.abrupt("return");case 7:o=(0,i.A)(a.tracks);try{for(o.s();!(c=o.n()).done;)((s=c.value).add||!s.replace&&!s.remove)&&(s.replace=!0)}catch(n){o.e(n)}finally{o.f()}return e.prev=9,e.next=12,Y(t,a);case 12:a.success(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(9),r.error(e.t0),a.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[9,15]])})))).apply(this,arguments)}function Y(e,r){return Q.apply(this,arguments)}function Q(){return(Q=(0,a.A)((0,n.A)().mark((function e(t,a){var o,c,s,d,u,l,f,p,v,g,m,h,b,y,w,S,T,x;return(0,n.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=C.get(t))&&o.webrtcStuff){e.next=4;break}throw r.warn("Invalid handle, not sending anything"),"Invalid handle";case 4:if((c=o.webrtcStuff).pc){e.next=8;break}throw r.warn("Invalid PeerConnection"),"Invalid PeerConnection";case 8:if((s=a.tracks)&&Array.isArray(s)&&0!==s.length){e.next=11;break}return e.abrupt("return");case 11:d=!1,u={},l=(0,i.A)(s),e.prev=14,l.s();case 16:if((f=l.n()).done){e.next=31;break}if(delete(p=f.value).gumGroup,p.type&&["audio","video"].includes(p.type)){e.next=21;break}return e.abrupt("continue",29);case 21:if(p.capture&&!(p.capture instanceof MediaStreamTrack)){e.next=23;break}return e.abrupt("continue",29);case 23:if(v=p.group?p.group:"default",u[v]||(u[v]={}),!u[v][p.type]){e.next=27;break}return e.abrupt("continue",29);case 27:p.gumGroup=v,u[v][p.type]=p;case 29:e.next=16;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(14),l.e(e.t0);case 36:return e.prev=36,l.f(),e.finish(36);case 39:for(g=Object.keys(u),m=0,h=g;m<h.length;m++)b=h[m],(y=u[b]).audio&&y.video||(y.audio&&delete y.audio.gumGroup,y.video&&delete y.video.gumGroup,delete u[b]);w=!!a.jsep,S=(0,i.A)(s),e.prev=43,x=(0,n.A)().mark((function e(){var a,s,l,f,p,v,g,m,h,b,y,S,C,x,A,I,O,R,P,E,j,D,N,M,V,_,G,J,F,W,U,B,z,q,H,Y;return(0,n.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=T.value).type){e.next=4;break}return r.warn("Missing track type:",a),e.abrupt("return",0);case 4:if("data"!==a.type){e.next=12;break}if(!c.pc.ondatachannel){e.next=8;break}return r.warn("Data channel exists already, not creating another one"),e.abrupt("return",0);case 8:return r.log("Creating default data channel"),L(t,r.dataChanDefaultLabel,null,!1),c.pc.ondatachannel=function(e){r.log("Data channel created by Janus:",e),L(t,e.channel.label,e.channel.protocol,e.channel)},e.abrupt("return",0);case 12:if("undefined"!==typeof a.add&&null!==a.add||"undefined"!==typeof a.remove&&null!==a.remove||"undefined"!==typeof a.replace&&null!==a.replace||(a.add=!0),!(a.add&&a.remove||a.add&&a.remove&&a.replace)){e.next=16;break}return r.warn("Conflicting actions for track, ignoring:",a),e.abrupt("return",0);case 16:if(a.add&&a.replace?(r.warn("Both add and replace provided, falling back to replace:",a),delete a.add):a.remove&&a.replace&&(r.warn("Both remove and replace provided, falling back to remove:",a),delete a.replace),s=a.type,"screen"===a.type&&(s="video"),l=null,f=null,a.mid?l=c.pc.getTransceivers().find((function(e){return e.mid===a.mid&&e.receiver.track.kind===s})):a.add||(l=c.pc.getTransceivers().find((function(e){return e.receiver.track.kind===s}))),!a.replace&&!a.remove){e.next=29;break}if(l){e.next=25;break}return r.warn("Couldn't find a transceiver for track:",a),e.abrupt("return",0);case 25:if(l.sender){e.next=28;break}return r.warn("No sender in the transceiver for track:",a),e.abrupt("return",0);case 28:f=l.sender;case 29:if(!w||l){e.next=34;break}if(l=c.pc.getTransceivers().find((function(e){return e.receiver.track.kind===s})),l){e.next=34;break}return r.warn("Couldn't find a transceiver for track:",a),e.abrupt("return",0);case 34:if(p=null,v=null,!a.remove&&!a.replace){e.next=41;break}return r.log("Removing track from PeerConnection",a),v=f.track?f.track.id:null,e.next=40,f.replaceTrack(null);case 40:if(v&&c.myStream){if(g=null,"audio"===s&&c.myStream.getAudioTracks()&&c.myStream.getAudioTracks().length){m=(0,i.A)(c.myStream.getAudioTracks());try{for(m.s();!(h=m.n()).done;)(b=h.value).id===v&&(g=b,r.log("Removing audio track:",g))}catch(n){m.e(n)}finally{m.f()}}else if("video"===s&&c.myStream.getVideoTracks()&&c.myStream.getVideoTracks().length){y=(0,i.A)(c.myStream.getVideoTracks());try{for(y.s();!(S=y.n()).done;)(C=S.value).id===v&&(g=C,r.log("Removing video track:",g))}catch(n){y.e(n)}finally{y.f()}}if(g){try{c.myStream.removeTrack(g),o.onlocaltrack(g,!1)}catch(Q){r.error("Error calling onlocaltrack on removal for renegotiation",Q)}if(!0!==g.dontStop)try{g.stop()}catch(Q){}}}case 41:if(!a.capture){e.next=120;break}if(!(a.gumGroup&&u[a.gumGroup]&&u[a.gumGroup].stream)){e.next=50;break}x=u[a.gumGroup].stream,p="audio"===a.type?x.getAudioTracks()[0]:x.getVideoTracks()[0],delete u[a.gumGroup].stream,delete u[a.gumGroup],delete a.gumGroup,e.next=68;break;case 50:if(!(a.capture instanceof MediaStreamTrack)){e.next=54;break}p=a.capture,e.next=68;break;case 54:if(d||(d=!0,o.consentDialog(!0)),A=r.trackConstraints(a),I=null,"audio"!==a.type&&"video"!==a.type){e.next=64;break}return a.gumGroup&&(O="audio"===a.type?"video":"audio",u[a.gumGroup]&&u[a.gumGroup][O]&&(R=u[a.gumGroup][O],P=r.trackConstraints(R),A[O]=P[O])),e.next=60,navigator.mediaDevices.getUserMedia(A);case 60:I=e.sent,a.gumGroup&&A.audio&&A.video&&(u[a.gumGroup].stream=I,delete a.gumGroup),e.next=67;break;case 64:return e.next=66,navigator.mediaDevices.getDisplayMedia(A);case 66:I=e.sent;case 67:p="audio"===a.type?I.getAudioTracks()[0]:I.getVideoTracks()[0];case 68:if(!a.replace){e.next=76;break}return e.next=71,f.replaceTrack(p);case 71:E="sendrecv",!1!==a.recv&&"inactive"!==l.direction&&"sendonly"!==l.direction||(E="sendonly"),l.setDirection?l.setDirection(E):l.direction=E,e.next=117;break;case 76:if(c.myStream||(c.myStream=new MediaStream),"audio"===s||!a.simulcast&&!a.svc?(f=c.pc.addTrack(p,c.myStream),l=c.pc.getTransceivers().find((function(e){return e.sender===f}))):a.simulcast?"firefox"!==r.webRTCAdapter.browserDetails.browser?(r.log("Enabling rid-based simulcasting:",p),j=k(a.simulcastMaxBitrates),l=c.pc.addTransceiver(p,{direction:"sendrecv",streams:[c.myStream],sendEncodings:a.sendEncodings||[{rid:"h",active:!0,scalabilityMode:"L1T2",maxBitrate:j.high},{rid:"m",active:!0,scalabilityMode:"L1T2",maxBitrate:j.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,scalabilityMode:"L1T2",maxBitrate:j.low,scaleResolutionDownBy:4}]})):(r.log("Enabling Simulcasting for Firefox (RID)"),l=c.pc.addTransceiver(p,{direction:"sendrecv",streams:[c.myStream]}),(f=l?l.sender:null)&&((D=f.getParameters())||(D={}),N=k(a.simulcastMaxBitrates),D.encodings=a.sendEncodings||[{rid:"h",active:!0,maxBitrate:N.high},{rid:"m",active:!0,maxBitrate:N.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:N.low,scaleResolutionDownBy:4}],f.setParameters(D))):(r.log("Enabling SVC ("+a.svc+"):",p),l=c.pc.addTransceiver(p,{direction:"sendrecv",streams:[c.myStream],sendEncodings:[{scalabilityMode:a.svc}]})),f||(f=l?l.sender:null),a.codec)if("firefox"===r.webRTCAdapter.browserDetails.browser)r.warn("setCodecPreferences not supported in Firefox, ignoring codec for track:",a);else if("string"!==typeof a.codec)r.warn("Invalid codec value, ignoring for track:",a);else if(M=s+"/"+a.codec.toLowerCase(),(V=RTCRtpReceiver.getCapabilities(s).codecs.filter((function(e){return e.mimeType.toLowerCase()===M})))&&0!==V.length){if(l)try{l.setCodecPreferences(V)}catch(n){r.warn("Failed enforcing codec for this "+s+" track:",n)}}else r.warn("Codec not supported in this browser for this track, ignoring:",a);if(!a.bitrate){e.next=98;break}if(!a.simulcast&&!a.svc){e.next=85;break}r.warn("Ignoring bitrate for simulcast/SVC track, use sendEncodings for that"),e.next=98;break;case 85:if(!(isNaN(a.bitrate)||a.bitrate<0)){e.next=89;break}r.warn("Ignoring invalid bitrate for track:",a),e.next=98;break;case 89:if(!f){e.next=98;break}if((_=f.getParameters())&&_.encodings&&0!==_.encodings.length){e.next=95;break}r.warn("No encodings in the sender parameters, ignoring bitrate for track:",a),e.next=98;break;case 95:return _.encodings[0].maxBitrate=a.bitrate,e.next=98,f.setParameters(_);case 98:if("video"!==s||!a.framerate){e.next=116;break}if(!a.simulcast&&!a.svc){e.next=103;break}r.warn("Ignoring framerate for simulcast/SVC track, use sendEncodings for that"),e.next=116;break;case 103:if(!(isNaN(a.framerate)||a.framerate<0)){e.next=107;break}r.warn("Ignoring invalid framerate for track:",a),e.next=116;break;case 107:if(!f){e.next=116;break}if((G=f.getParameters())&&G.encodings&&0!==G.encodings.length){e.next=113;break}r.warn("No encodings in the sender parameters, ignoring framerate for track:",a),e.next=116;break;case 113:return G.encodings[0].maxFramerate=a.framerate,e.next=116,f.setParameters(G);case 116:a.transforms&&(f&&a.transforms.sender&&(J=null,RTCRtpSender.prototype.createEncodedStreams?J=f.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===s?J=f.createEncodedAudioStreams():"video"===s&&(J=f.createEncodedVideoStreams())),J&&(J.readableStream&&J.writableStream?J.readableStream.pipeThrough(a.transforms.sender).pipeTo(J.writableStream):J.readable&&J.writable&&J.readable.pipeThrough(a.transforms.sender).pipeTo(J.writable))),l&&l.receiver&&a.transforms.receiver&&(F=null,RTCRtpReceiver.prototype.createEncodedStreams?F=l.receiver.createEncodedStreams():(RTCRtpReceiver.prototype.createAudioEncodedStreams||RTCRtpReceiver.prototype.createEncodedVideoStreams)&&("audio"===s?F=l.receiver.createEncodedAudioStreams():"video"===s&&(F=l.receiver.createEncodedVideoStreams())),F&&(F.readableStream&&F.writableStream?F.readableStream.pipeThrough(a.transforms.receiver).pipeTo(F.writableStream):F.readable&&F.writable&&F.readable.pipeThrough(a.transforms.receiver).pipeTo(F.writable))));case 117:p&&!0===a.dontStop&&(p.dontStop=!0),e.next=121;break;case 120:if(a.recv&&(l||(l=c.pc.addTransceiver(s)),l)){if(a.codec)if("firefox"===r.webRTCAdapter.browserDetails.browser)r.warn("setCodecPreferences not supported in Firefox, ignoring codec for track:",a);else if("string"!==typeof a.codec)r.warn("Invalid codec value, ignoring for track:",a);else if(W=s+"/"+a.codec.toLowerCase(),(U=RTCRtpReceiver.getCapabilities(s).codecs.filter((function(e){return e.mimeType.toLowerCase()===W})))&&0!==U.length)try{l.setCodecPreferences(U)}catch(n){r.warn("Failed enforcing codec for this "+s+" track:",n)}else r.warn("Codec not supported in this browser for this track, ignoring:",a);l.receiver&&a.transforms&&a.transforms.receiver&&(B=null,RTCRtpReceiver.prototype.createEncodedStreams?B=l.receiver.createEncodedStreams():(RTCRtpReceiver.prototype.createAudioEncodedStreams||RTCRtpReceiver.prototype.createEncodedVideoStreams)&&("audio"===s?B=l.receiver.createEncodedAudioStreams():"video"===s&&(B=l.receiver.createEncodedVideoStreams())),B&&(B.readableStream&&B.writableStream?B.readableStream.pipeThrough(a.transforms.receiver).pipeTo(B.writableStream):B.readable&&B.writable&&B.readable.pipeThrough(a.transforms.receiver).pipeTo(B.writable)))}case 121:if(p){c.myStream.addTrack(p),p.onended=function(e){r.log("Local track removed:",e);try{o.onlocaltrack(e.target,!1)}catch(Q){r.error("Error calling onlocaltrack following end",Q)}};try{o.onlocaltrack(p,!0)}catch(Q){r.error("Error calling onlocaltrack for track add",Q)}}l&&(z=l.direction,q=null,H=p&&l.sender.track,Y=!1!==a.recv&&l.receiver.track,H&&Y?q="sendrecv":H&&!Y?q="sendonly":!H&&Y?q="recvonly":H||Y||(q="inactive"),q&&q!==z&&(r.warn("Changing direction of transceiver to "+q+" (was "+z+")",a),l.setDirection?l.setDirection(q):l.direction=q));case 123:case"end":return e.stop()}}),e)})),S.s();case 46:if((T=S.n()).done){e.next=53;break}return e.delegateYield(x(),"t1",48);case 48:if(0!==e.t1){e.next=51;break}return e.abrupt("continue",51);case 51:e.next=46;break;case 53:e.next=58;break;case 55:e.prev=55,e.t2=e.catch(43),S.e(e.t2);case 58:return e.prev=58,S.f(),e.finish(58);case 61:d&&o.consentDialog(!1);case 62:case"end":return e.stop()}}),e,null,[[14,33,36,39],[43,55,58,61]])})))).apply(this,arguments)}function K(e){var t=C.get(e);if(!t||!t.webrtcStuff)return r.warn("Invalid handle"),null;var n=t.webrtcStuff;if(!n.pc)return r.warn("Invalid PeerConnection"),null;var a,o=[],c=n.pc.getTransceivers(),s=(0,i.A)(c);try{for(s.s();!(a=s.n()).done;){var d=a.value,u=null;d.sender&&d.sender.track&&((u={mid:d.mid}).type=d.sender.track.kind,u.id=d.sender.track.id,u.label=d.sender.track.label),u&&o.push(u)}}catch(l){s.e(l)}finally{s.f()}return o}function X(e){var t=C.get(e);if(!t||!t.webrtcStuff)return r.warn("Invalid handle"),null;var n=t.webrtcStuff;if(!n.pc)return r.warn("Invalid PeerConnection"),null;var a,o=[],c=n.pc.getTransceivers(),s=(0,i.A)(c);try{for(s.s();!(a=s.n()).done;){var d=a.value,u=null;d.receiver&&d.receiver.track&&((u={mid:d.mid}).type=d.receiver.track.kind,u.id=d.receiver.track.id,u.label=d.receiver.track.label),u&&o.push(u)}}catch(l){s.e(l)}finally{s.f()}return o}function Z(e,t,n,a){a="function"==typeof a?a:r.noop;var o=C.get(e);if(!o||!o.webrtcStuff)return r.warn("Invalid handle"),void a(0);var i=n?"remote":"local",c=o.webrtcStuff;if(c.volume[i]||(c.volume[i]={value:0}),c.pc&&c.pc.getStats&&("chrome"===r.webRTCAdapter.browserDetails.browser||"safari"===r.webRTCAdapter.browserDetails.browser)){var s=c.pc;if(t){var d=c.pc.getTransceivers().find((function(e){return e.mid===t&&"audio"===e.receiver.track.kind}));if(!d)return r.warn("No audio transceiver with mid "+t),void a(0);if(n&&!d.receiver)return r.warn("Remote transceiver track unavailable"),void a(0);if(!n&&!d.sender)return r.warn("Local transceiver track unavailable"),void a(0);s=n?d.receiver:d.sender}return s.getStats().then((function(e){e.forEach((function(e){e&&"audio"===e.kind&&(n&&!e.remoteSource||!n&&"media-source"!==e.type||a(e.audioLevel?e.audioLevel:0))}))})),c.volume[i].value}return r.warn("Getting the "+i+" volume unsupported by browser"),void a(0)}function $(e,t,n){var a=C.get(e);if(!a||!a.webrtcStuff)return r.warn("Invalid handle"),!0;var o=a.webrtcStuff;if(!o.pc)return r.warn("Invalid PeerConnection"),!0;if(!o.myStream)return r.warn("Invalid local MediaStream"),!0;if(n){if(!o.myStream.getVideoTracks()||0===o.myStream.getVideoTracks().length)return r.warn("No video track"),!0;if(t){var i=o.pc.getTransceivers().find((function(e){return e.mid===t&&"video"===e.receiver.track.kind}));return i?i.sender&&i.sender.track?!i.sender.track.enabled:(r.warn("No video sender with mid "+t),!0):(r.warn("No video transceiver with mid "+t),!0)}return!o.myStream.getVideoTracks()[0].enabled}if(!o.myStream.getAudioTracks()||0===o.myStream.getAudioTracks().length)return r.warn("No audio track"),!0;if(t){var c=o.pc.getTransceivers().find((function(e){return e.mid===t&&"audio"===e.receiver.track.kind}));return c?c.sender&&c.sender.track?!c.sender.track.enabled:(r.warn("No audio sender with mid "+t),!0):(r.warn("No audio transceiver with mid "+t),!0)}return!o.myStream.getAudioTracks()[0].enabled}function ee(e,t,n,a){var o=C.get(e);if(!o||!o.webrtcStuff)return r.warn("Invalid handle"),!1;var c=o.webrtcStuff;if(!c.pc)return r.warn("Invalid PeerConnection"),!1;if(!c.myStream)return r.warn("Invalid local MediaStream"),!1;if(n){if(!c.myStream.getVideoTracks()||0===c.myStream.getVideoTracks().length)return r.warn("No video track"),!1;if(t){var s=c.pc.getTransceivers().find((function(e){return e.mid===t&&"video"===e.receiver.track.kind}));if(!s)return r.warn("No video transceiver with mid "+t),!1;if(!s.sender||!s.sender.track)return r.warn("No video sender with mid "+t),!1;s.sender.track.enabled=!a}else{var d,u=(0,i.A)(c.myStream.getVideoTracks());try{for(u.s();!(d=u.n()).done;){d.value.enabled=!a}}catch(v){u.e(v)}finally{u.f()}}}else{if(!c.myStream.getAudioTracks()||0===c.myStream.getAudioTracks().length)return r.warn("No audio track"),!1;if(t){var l=c.pc.getTransceivers().find((function(e){return e.mid===t&&"audio"===e.receiver.track.kind}));if(!l)return r.warn("No audio transceiver with mid "+t),!1;if(!l.sender||!l.sender.track)return r.warn("No audio sender with mid "+t),!1;l.sender.track.enabled=!a}else{var f,p=(0,i.A)(c.myStream.getAudioTracks());try{for(p.s();!(f=p.n()).done;){f.value.enabled=!a}}catch(v){p.e(v)}finally{p.f()}}}return!0}function re(e,t){var n=C.get(e);if(!n||!n.webrtcStuff)return r.warn("Invalid handle"),"Invalid handle";var a=n.webrtcStuff;if(!a.pc)return"Invalid PeerConnection";if(a.pc.getStats){var o=a.pc,i=t||"default";if(t){var c=a.pc.getTransceivers().find((function(e){return e.mid===t&&"video"===e.receiver.track.kind}));if(!c)return r.warn("No video transceiver with mid "+t),"No video transceiver with mid "+t;if(!c.receiver)return r.warn("No video receiver with mid "+t),"No video receiver with mid "+t;o=c.receiver}return a.bitrate[i]||(a.bitrate[i]={timer:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,value:"0 kbits/sec"}),a.bitrate[i].timer?a.bitrate[i].value:(r.log("Starting bitrate timer"+(t?" for mid "+t:"")+" (via getStats)"),a.bitrate[i].timer=setInterval((function(){o.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||"video"===e.kind||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(a.bitrate[i].bsnow=e.bytesReceived,a.bitrate[i].tsnow=e.timestamp,null===a.bitrate[i].bsbefore||null===a.bitrate[i].tsbefore)a.bitrate[i].bsbefore=a.bitrate[i].bsnow,a.bitrate[i].tsbefore=a.bitrate[i].tsnow;else{var n=a.bitrate[i].tsnow-a.bitrate[i].tsbefore;"safari"===r.webRTCAdapter.browserDetails.browser&&(n/=1e3);var o=Math.round(8*(a.bitrate[i].bsnow-a.bitrate[i].bsbefore)/n);"safari"===r.webRTCAdapter.browserDetails.browser&&(o=parseInt(o/1e3)),a.bitrate[i].value=o+" kbits/sec",a.bitrate[i].bsbefore=a.bitrate[i].bsnow,a.bitrate[i].tsbefore=a.bitrate[i].tsnow}}}))}))}),1e3),"0 kbits/sec")}return r.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"}function te(e,t,n){var a=C.get(e);if(a&&a.webrtcStuff){var o=a.webrtcStuff;if(o.pc){var i=o.pc.getTransceivers().find((function(e){return e.mid===t}));if(i)if(i.sender){var c=i.sender.getParameters();c&&c.encodings&&0!==c.encodings.length?c.encodings.length>1?r.warn("Ignoring bitrate for simulcast track, use sendEncodings for that"):isNaN(n)||n<0?r.warn("Invalid bitrate (must be a positive integer)"):(c.encodings[0].maxBitrate=n,i.sender.setParameters(c)):r.warn("No parameters encodings")}else r.warn("No sender for transceiver with mid",t);else r.warn("No transceiver with mid",t)}else r.warn("Invalid PeerConnection")}else r.warn("Invalid handle")}function ne(e){r.error("WebRTC error:",e)}function ae(e,n){r.log("Cleaning WebRTC stuff");var a=C.get(e);if(a){var i=a.webrtcStuff;if(i){if(!0===n){var c={janus:"hangup",transaction:r.randomString(12)};a.token&&(c.token=a.token),b&&(c.apisecret=b),r.debug("Sending hangup request (handle="+e+"):"),r.debug(c),t?(c.session_id=T,c.handle_id=e,o.send(JSON.stringify(c))):r.httpAPICall(l+"/"+T+"/"+e,{verb:"POST",withCredentials:g,body:c})}for(var s in i.volume&&(i.volume.local&&i.volume.local.timer&&clearInterval(i.volume.local.timer),i.volume.remote&&i.volume.remote.timer&&clearInterval(i.volume.remote.timer)),i.bitrate)i.bitrate[s].timer&&clearInterval(i.bitrate[s].timer);i.bitrate={},!i.streamExternal&&i.myStream&&(r.log("Stopping local stream tracks"),r.stopAllTracks(i.myStream)),i.streamExternal=!1,i.myStream=null;try{i.pc.close()}catch(d){}i.pc=null,i.candidates=null,i.mySdp=null,i.remoteSdp=null,i.iceDone=!1,i.dataChannel={},i.dtmfSender=null,i.insertableStreams=!1,i.externalEncryption=!1}a.oncleanup()}}function oe(e){return r.debug("isTrickleEnabled:",e),!1!==e}E(e),this.getServer=function(){return l},this.isConnected=function(){return S},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:r.noop,e.error="function"==typeof e.error?e.error:r.noop,e.reconnect=!0,E(e)},this.getSessionId=function(){return T},this.getInfo=function(e){!function(e){if(e=e||{},e.success="function"==typeof e.success?e.success:r.noop,e.error="function"==typeof e.error?e.error:r.noop,r.log("Getting info on Janus instance"),!S)return r.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var n=r.randomString(12),a={janus:"info",transaction:n};h&&(a.token=h);b&&(a.apisecret=b);if(t)return I.set(n,(function(t){r.log("Server info:"),r.debug(t),"server_info"!==t.janus&&r.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)})),void o.send(JSON.stringify(a));r.httpAPICall(l,{verb:"POST",withCredentials:g,body:a,success:function(t){r.log("Server info:"),r.debug(t),"server_info"!==t.janus&&r.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},error:function(t,n){r.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)},this.destroy=function(n){!function(n){n=n||{},n.success="function"==typeof n.success?n.success:r.noop,n.error="function"==typeof n.error?n.error:r.noop;var a=!0===n.unload,d=!0;"undefined"!==typeof n.notifyDestroyed&&null!==n.notifyDestroyed&&(d=!0===n.notifyDestroyed);var u=!0===n.cleanupHandles;if(r.log("Destroying session "+T+" (unload="+a+")"),!T)return r.warn("No session to destroy"),n.success(),void(d&&e.destroyed());if(u){var f,p=(0,i.A)(C.keys());try{for(p.s();!(f=p.n()).done;){V(f.value,{noRequest:!0})}}catch(k){p.e(k)}finally{p.f()}}if(!S)return r.warn("Is the server down? (connected=false)"),T=null,void n.success();var v={janus:"destroy",transaction:r.randomString(12)};h&&(v.token=h);b&&(v.apisecret=b);if(a)return t?(o.onclose=null,o.close(),o=null):navigator.sendBeacon(l+"/"+T,JSON.stringify(v)),r.log("Destroyed session:"),T=null,S=!1,n.success(),void(d&&e.destroyed());if(t){v.session_id=T;var m=function(){for(var e in c)o.removeEventListener(e,c[e]);o.removeEventListener("message",y),o.removeEventListener("error",w),s&&clearTimeout(s),o.close()},y=function(r){var t=JSON.parse(r.data);t.session_id==v.session_id&&t.transaction==v.transaction&&(m(),n.success(),d&&e.destroyed())},w=function(){m(),n.error("Failed to destroy the server: Is the server down?"),d&&e.destroyed()};return o.addEventListener("message",y),o.addEventListener("error",w),void(1===o.readyState?o.send(JSON.stringify(v)):w())}r.httpAPICall(l+"/"+T,{verb:"POST",withCredentials:g,body:v,success:function(t){r.log("Destroyed session:"),r.debug(t),T=null,S=!1,"success"!==t.janus&&r.error("Ooops: "+t.error.code+" "+t.error.reason),n.success(),d&&e.destroyed()},error:function(t,a){r.error(t+":",a),T=null,S=!1,n.success(),d&&e.destroyed()}})}(n)},this.attach=function(e){!function(e){if(e=e||{},e.success="function"==typeof e.success?e.success:r.noop,e.error="function"==typeof e.error?e.error:r.noop,e.dataChannelOptions=e.dataChannelOptions||{ordered:!0},e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:r.noop,e.connectionState="function"==typeof e.connectionState?e.connectionState:r.noop,e.iceState="function"==typeof e.iceState?e.iceState:r.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:r.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:r.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:r.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:r.noop,e.onlocaltrack="function"==typeof e.onlocaltrack?e.onlocaltrack:r.noop,e.onremotetrack="function"==typeof e.onremotetrack?e.onremotetrack:r.noop,e.ondata="function"==typeof e.ondata?e.ondata:r.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:r.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:r.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:r.noop,!S)return r.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var n=e.plugin;if(!n)return r.error("Invalid plugin"),void e.error("Invalid plugin");var a=e.opaqueId,i=e.loopIndex,c=e.token?e.token:h,s=r.randomString(12),d={janus:"attach",plugin:n,opaque_id:a,loop_index:i,transaction:s};c&&(d.token=c);b&&(d.apisecret=b);if(t)return I.set(s,(function(t){if(r.debug(t),"success"!==t.janus)return r.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var a=t.data.id;r.log("Created handle: "+a);var o={session:x,plugin:n,id:a,token:c,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:e.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,bitrate:{}},getId:function(){return a},getPlugin:function(){return n},getVolume:function(e,r){return Z(a,e,!0,r)},getRemoteVolume:function(e,r){return Z(a,e,!0,r)},getLocalVolume:function(e,r){return Z(a,e,!1,r)},isAudioMuted:function(e){return $(a,e,!1)},muteAudio:function(e){return ee(a,e,!1,!0)},unmuteAudio:function(e){return ee(a,e,!1,!1)},isVideoMuted:function(e){return $(a,e,!0)},muteVideo:function(e){return ee(a,e,!0,!0)},unmuteVideo:function(e){return ee(a,e,!0,!1)},getBitrate:function(e){return re(a,e)},setMaxBitrate:function(e,r){return te(a,e,r)},send:function(e){j(a,e)},data:function(e){N(a,e)},dtmf:function(e){M(a,e)},consentDialog:e.consentDialog,connectionState:e.connectionState,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){G(a,!0,e)},createAnswer:function(e){G(a,!1,e)},handleRemoteJsep:function(e){F(a,e)},replaceTracks:function(e){q(a,e)},getLocalTracks:function(){return K(a)},getRemoteTracks:function(){return X(a)},onlocaltrack:e.onlocaltrack,onremotetrack:e.onremotetrack,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){ae(a,!0===e)},detach:function(e){V(a,e)}};C.set(a,o),e.success(o)})),d.session_id=T,void o.send(JSON.stringify(d));r.httpAPICall(l+"/"+T,{verb:"POST",withCredentials:g,body:d,success:function(t){if(r.debug(t),"success"!==t.janus)return r.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var a=t.data.id;r.log("Created handle: "+a);var o={session:x,plugin:n,id:a,token:c,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:e.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,bitrate:{}},getId:function(){return a},getPlugin:function(){return n},getVolume:function(e,r){return Z(a,e,!0,r)},getRemoteVolume:function(e,r){return Z(a,e,!0,r)},getLocalVolume:function(e,r){return Z(a,e,!1,r)},isAudioMuted:function(e){return $(a,e,!1)},muteAudio:function(e){return ee(a,e,!1,!0)},unmuteAudio:function(e){return ee(a,e,!1,!1)},isVideoMuted:function(e){return $(a,e,!0)},muteVideo:function(e){return ee(a,e,!0,!0)},unmuteVideo:function(e){return ee(a,e,!0,!1)},getBitrate:function(e){return re(a,e)},setMaxBitrate:function(e,r){return te(a,e,r)},send:function(e){j(a,e)},data:function(e){N(a,e)},dtmf:function(e){M(a,e)},consentDialog:e.consentDialog,connectionState:e.connectionState,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){G(a,!0,e)},createAnswer:function(e){G(a,!1,e)},handleRemoteJsep:function(e){F(a,e)},replaceTracks:function(e){q(a,e)},getLocalTracks:function(){return K(a)},getRemoteTracks:function(){return X(a)},onlocaltrack:e.onlocaltrack,onremotetrack:e.onremotetrack,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){ae(a,!0===e)},detach:function(e){V(a,e)}};C.set(a,o),e.success(o)},error:function(t,n){r.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)}}return r.useDefaultDependencies=function(t){var n=t&&t.fetch||fetch,a=t&&t.Promise||Promise,o=t&&t.WebSocket||WebSocket;return{newWebSocket:function(e,r){return new o(e,r)},extension:t&&t.extension||e,isArray:function(e){return Array.isArray(e)},webRTCAdapter:t&&t.adapter||adapter,httpAPICall:function(e,t){var o={method:t.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===t.verb&&(o.headers["Content-Type"]="application/json"),"undefined"!==typeof t.withCredentials&&(o.credentials=!0===t.withCredentials?"include":t.withCredentials?t.withCredentials:"omit"),t.body&&(o.body=JSON.stringify(t.body));var i=n(e,o).catch((function(e){return a.reject({message:"Probably a network error, is the server down?",error:e})}));if(t.timeout){var c=new a((function(e,r){var n=setTimeout((function(){return clearTimeout(n),r({message:"Request timed out",timeout:t.timeout})}),t.timeout)}));i=a.race([i,c])}return i.then((function(e){return e.ok?typeof t.success===typeof r.noop?e.json().then((function(e){try{t.success(e)}catch(n){r.error("Unhandled httpAPICall success callback error",n)}}),(function(r){return a.reject({message:"Failed to parse response body",error:r,response:e})})):void 0:a.reject({message:"API call failed",response:e})})).catch((function(e){typeof t.error===typeof r.noop&&t.error(e.message||"<< internal error >>",e)})),i}}},r.useOldDependencies=function(t){var n=t&&t.jQuery||jQuery,a=t&&t.WebSocket||WebSocket;return{newWebSocket:function(e,r){return new a(e,r)},isArray:function(e){return n.isArray(e)},extension:t&&t.extension||e,webRTCAdapter:t&&t.adapter||adapter,httpAPICall:function(e,t){var a="undefined"!==typeof t.body?{contentType:"application/json",data:JSON.stringify(t.body)}:{},o="undefined"!==typeof t.withCredentials?{xhrFields:{withCredentials:t.withCredentials}}:{};return n.ajax(n.extend(a,o,{url:e,type:t.verb,cache:!1,dataType:"json",async:t.async,timeout:t.timeout,success:function(e){typeof t.success===typeof r.noop&&t.success(e)},error:function(e,n,a){typeof t.error===typeof r.noop&&t.error(n,a)}}))}}},r.mediaToTracks=function(e){var r=[];if(e){if(!e.keepAudio&&!1!==e.audio&&("undefined"===typeof e.audio||e.audio||e.audioSend||e.audioRecv||e.addAudio||e.replaceAudio||e.removeAudio)){var t={type:"audio"};e.removeAudio?t.remove=!0:(e.addAudio?t.add=!0:e.replaceAudio&&(t.replace=!0),!1!==e.audioSend&&(t.capture=e.audio||!0),!1!==e.audioRecv&&(t.recv=!0)),(t.remove||t.capture||t.recv)&&r.push(t)}if(!e.keepVideo&&!1!==e.video&&("undefined"===typeof e.video||e.video||e.videoSend||e.videoRecv||e.addVideo||e.replaceVideo||e.removeVideo)){var n={type:"video"};e.removeVideo?n.remove=!0:(e.addVideo?n.add=!0:e.replaceVideo&&(n.replace=!0),!1!==e.videoSend&&(n.capture=e.video||!0,["screen","window","desktop"].includes(n.capture)&&(n.type="screen",n.capture={video:{}},e.screenshareFrameRate&&(n.capture.frameRate=e.screenshareFrameRate),e.screenshareHeight&&(n.capture.height=e.screenshareHeight),e.screenshareWidth&&(n.capture.width=e.screenshareWidth))),!1!==e.videoRecv&&(n.recv=!0)),(n.remove||n.capture||n.recv)&&r.push(n)}e.data&&r.push({type:"data"})}else r.push({type:"audio",capture:!0,recv:!0}),r.push({type:"video",capture:!0,recv:!0});return r},r.trackConstraints=function(e){var t={};if(!e||!e.capture)return t;if("audio"===e.type)t.audio=e.capture;else if("video"===e.type)if((e.simulcast||e.svc)&&!0===e.capture&&(e.capture="hires"),!0===e.capture||"object"===typeof e.capture)t.video=e.capture;else{var n=0,a=0;"lowres"===e.capture?(n=320,a=240):"lowres-16:9"===e.capture?(n=320,a=180):"hires"===e.capture||"hires-16:9"===e.capture||"hdres"===e.capture?(n=1280,a=720):"fhdres"===e.capture?(n=1920,a=1080):"4kres"===e.capture?(n=3840,a=2160):"stdres"===e.capture?(n=640,a=480):"stdres-16:9"===e.capture?(n=640,a=360):(r.log("Default video setting is stdres 4:3"),n=640,a=480),t.video={width:{ideal:n},height:{ideal:a}}}else"screen"===e.type&&(t.video=e.capture);return t},r.noop=function(){},r.dataChanDefaultLabel="JanusDataChannel",r.endOfCandidates=null,r.stopAllTracks=function(e){try{var t,n=e.getTracks(),a=(0,i.A)(n);try{for(a.s();!(t=a.n()).done;){var o=t.value;r.log(o),o&&!0!==o.dontStop&&o.stop()}}catch(c){a.e(c)}finally{a.f()}}catch(s){}},r.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:r.noop,r.initDone)e.callback();else{if("undefined"==typeof console.log&&(console.log=function(){}),r.trace=r.noop,r.debug=r.noop,r.vdebug=r.noop,r.log=r.noop,r.warn=r.noop,r.error=r.noop,!0===e.debug||"all"===e.debug)r.trace=console.trace.bind(console),r.debug=console.debug.bind(console),r.vdebug=console.debug.bind(console),r.log=console.log.bind(console),r.warn=console.warn.bind(console),r.error=console.error.bind(console);else if(Array.isArray(e.debug)){var t,n=(0,i.A)(e.debug);try{for(n.s();!(t=n.n()).done;){switch(t.value){case"trace":r.trace=console.trace.bind(console);break;case"debug":r.debug=console.debug.bind(console);break;case"vdebug":r.vdebug=console.debug.bind(console);break;case"log":r.log=console.log.bind(console);break;case"warn":r.warn=console.warn.bind(console);break;case"error":r.error=console.error.bind(console)}}}catch(p){n.e(p)}finally{n.f()}}r.log("Initializing library");var a=e.dependencies||r.useDefaultDependencies();r.isArray=a.isArray,r.webRTCAdapter=a.webRTCAdapter,r.httpAPICall=a.httpAPICall,r.newWebSocket=a.newWebSocket,r.extension=a.extension,r.extension.init(),r.listDevices=function(e,t){e="function"==typeof e?e:r.noop,t||(t={audio:!0,video:!0}),r.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(n){r.debug(n),e(n),r.stopAllTracks(t)}))})).catch((function(t){r.error(t),e([])})):(r.warn("navigator.mediaDevices unavailable"),e([]))},r.attachMediaStream=function(e,t){try{e.srcObject=t}catch(n){try{e.src=URL.createObjectURL(t)}catch(n){r.error("Error attaching stream to element",n)}}},r.reattachMediaStream=function(e,t){try{e.srcObject=t.srcObject}catch(n){try{e.src=t.src}catch(n){r.error("Error reattaching stream to element",n)}}};var c=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",s=window["on"+c];if(window.addEventListener(c,(function(){r.log("Closing window");var e,t=(0,i.A)(r.sessions);try{for(t.s();!(e=t.n()).done;){var n=(0,o.A)(e.value,2),a=n[0],c=n[1];c&&c.destroyOnUnload&&(r.log("Destroying session "+a),c.destroy({unload:!0,notifyDestroyed:!1}))}}catch(p){t.e(p)}finally{t.f()}s&&"function"==typeof s&&s()})),r.safariVp8=!1,r.safariVp9=!1,"safari"===r.webRTCAdapter.browserDetails.browser&&r.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){var d,u=(0,i.A)(RTCRtpSender.getCapabilities("video").codecs);try{for(u.s();!(d=u.n()).done;){var l=d.value;l&&l.mimeType&&"video/vp8"===l.mimeType.toLowerCase()?r.safariVp8=!0:l&&l.mimeType&&"video/vp9"===l.mimeType.toLowerCase()&&(r.safariVp9=!0)}}catch(p){u.e(p)}finally{u.f()}r.safariVp8?r.log("This version of Safari supports VP8"):r.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var f=new RTCPeerConnection({});f.createOffer({offerToReceiveVideo:!0}).then((function(e){r.safariVp8=-1!==e.sdp.indexOf("VP8"),r.safariVp9=-1!==e.sdp.indexOf("VP9"),r.safariVp8?r.log("This version of Safari supports VP8"):r.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),f.close(),f=null}))}r.initDone=!0,e.callback()}},r.isWebrtcSupported=function(){return!!window.RTCPeerConnection},r.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},r.randomString=function(e){for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<e;n++){var a=Math.floor(62*Math.random());t+=r.charAt(a)}return t},r}))},10467:function(e,r,t){function n(e,r,t,n,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void t(e)}c.done?r(s):Promise.resolve(s).then(n,a)}function a(e){return function(){var r=this,t=arguments;return new Promise((function(a,o){var i=e.apply(r,t);function c(e){n(i,a,o,c,s,"next",e)}function s(e){n(i,a,o,c,s,"throw",e)}c(void 0)}))}}t.d(r,{A:function(){return a}})},90675:function(e,r,t){t.d(r,{A:function(){return a}});var n=t(82284);function a(){a=function(){return r};var e,r={},t=Object.prototype,o=t.hasOwnProperty,i=Object.defineProperty||function(e,r,t){e[r]=t.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function l(e,r,t){return Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{l({},"")}catch(e){l=function(e,r,t){return e[r]=t}}function f(e,r,t,n){var a=r&&r.prototype instanceof y?r:y,o=Object.create(a.prototype),c=new j(n||[]);return i(o,"_invoke",{value:O(e,t,c)}),o}function p(e,r,t){try{return{type:"normal",arg:e.call(r,t)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var v="suspendedStart",g="suspendedYield",m="executing",h="completed",b={};function y(){}function w(){}function k(){}var S={};l(S,s,(function(){return this}));var T=Object.getPrototypeOf,C=T&&T(T(D([])));C&&C!==t&&o.call(C,s)&&(S=C);var x=k.prototype=y.prototype=Object.create(S);function A(e){["next","throw","return"].forEach((function(r){l(e,r,(function(e){return this._invoke(r,e)}))}))}function I(e,r){function t(a,i,c,s){var d=p(e[a],e,i);if("throw"!==d.type){var u=d.arg,l=u.value;return l&&"object"==(0,n.A)(l)&&o.call(l,"__await")?r.resolve(l.__await).then((function(e){t("next",e,c,s)}),(function(e){t("throw",e,c,s)})):r.resolve(l).then((function(e){u.value=e,c(u)}),(function(e){return t("throw",e,c,s)}))}s(d.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new r((function(r,a){t(e,n,r,a)}))}return a=a?a.then(o,o):o()}})}function O(r,t,n){var a=v;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===h){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var c=n.delegate;if(c){var s=R(c,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===v)throw a=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=m;var d=p(r,t,n);if("normal"===d.type){if(a=n.done?h:g,d.arg===b)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(a=h,n.method="throw",n.arg=d.arg)}}}function R(r,t){var n=t.method,a=r.iterator[n];if(a===e)return t.delegate=null,"throw"===n&&r.iterator.return&&(t.method="return",t.arg=e,R(r,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var o=p(a,r.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,b;var i=o.arg;return i?i.done?(t[r.resultName]=i.value,t.next=r.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,b):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,b)}function P(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function E(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function D(r){if(r||""===r){var t=r[s];if(t)return t.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var a=-1,i=function t(){for(;++a<r.length;)if(o.call(r,a))return t.value=r[a],t.done=!1,t;return t.value=e,t.done=!0,t};return i.next=i}}throw new TypeError((0,n.A)(r)+" is not iterable")}return w.prototype=k,i(x,"constructor",{value:k,configurable:!0}),i(k,"constructor",{value:w,configurable:!0}),w.displayName=l(k,u,"GeneratorFunction"),r.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,l(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},r.awrap=function(e){return{__await:e}},A(I.prototype),l(I.prototype,d,(function(){return this})),r.AsyncIterator=I,r.async=function(e,t,n,a,o){void 0===o&&(o=Promise);var i=new I(f(e,t,n,a),o);return r.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(x),l(x,u,"Generator"),l(x,s,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var r=Object(e),t=[];for(var n in r)t.push(n);return t.reverse(),function e(){for(;t.length;){var n=t.pop();if(n in r)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=D,j.prototype={constructor:j,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!r)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var t=this;function n(n,a){return c.type="throw",c.arg=r,t.next=n,a&&(t.method="next",t.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),d=o.call(i,"finallyLoc");if(s&&d){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!d)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,r){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=r,a?(this.method="next",this.next=a.finallyLoc,b):this.complete(i)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),b},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),E(t),b}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var a=n.arg;E(t)}return a}}throw Error("illegal catch attempt")},delegateYield:function(r,t,n){return this.delegate={iterator:D(r),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=e),b}},r}},13441:function(e,r,t){t.d(r,{k5:function(){return p}});var n=t(65043),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=n.createContext&&n.createContext(a),i=["attr","size","title"];function c(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(r.indexOf(n)>=0)continue;t[n]=e[n]}return t}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},s.apply(this,arguments)}function d(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function u(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?d(Object(t),!0).forEach((function(r){l(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function l(e,r,t){return(r=function(e){var r=function(e,r){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function f(e){return e&&e.map((function(e,r){return n.createElement(e.tag,u({key:r},e.attr),f(e.child))}))}function p(e){return function(r){return n.createElement(v,s({attr:u({},e.attr)},r),f(e.child))}}function v(e){var r=function(r){var t,a=e.attr,o=e.size,d=e.title,l=c(e,i),f=o||r.size||"1em";return r.className&&(t=r.className),e.className&&(t=(t?t+" ":"")+e.className),n.createElement("svg",s({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,l,{className:t,style:u(u({color:e.color||r.color},r.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),d&&n.createElement("title",null,d),e.children)};return void 0!==o?n.createElement(o.Consumer,null,(function(e){return r(e)})):r(a)}}}]);
//# sourceMappingURL=674.ecd42ac3.chunk.js.map