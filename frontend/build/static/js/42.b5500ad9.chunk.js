"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[42],{35042:function(e,n,t){t.r(n);var r=t(90675),s=t(10467),o=t(5544),c=t(65043),a=(t(58650),t(60184)),i=t(70579);n.default=function(){var e=(0,c.useState)(!1),n=(0,o.A)(e,2),t=n[0],u=n[1],l=(0,c.useState)(!1),d=(0,o.A)(l,2),f=d[0],m=(d[1],(0,c.useRef)(null)),p=useConnectSocket(user),v=(0,c.useState)(!1),g=(0,o.A)(v,2),h=g[0],j=g[1],S=(0,c.useRef)(null),x=new WebSocket("ws://167.99.44.195:8188");x.onopen=function(){console.log("Connected to Janus WebSocket server"),p.send(JSON.stringify({janus:"attach",plugin:"janus.plugin.rtmp"}))},x.onmessage=function(e){var n=JSON.parse(e.data);console.log("Received message from Janus:",n)},x.onerror=function(e){console.error("WebSocket error:",e)},x.onclose=function(){console.log("WebSocket connection closed")},(0,c.useEffect)((function(){if(p)return j(p.connected),p.on("connect",(function(){return j(!0)})),p.on("disconnect",(function(){return j(!1)})),p.on("stream-started",(function(e){console.log("Streaming started:",e),b()})),p.on("stream-stopped",(function(){console.log("Streaming stopped"),u(!1)})),p.on("error",(function(e){console.error("Socket.IO error:",e)})),function(){p.off("stream-started"),p.off("stream-stopped"),p.off("error")}}),[p]);var k=function(){var e=(0,s.A)((0,r.A)().mark((function e(){var n;return(0,r.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:n=e.sent,S.current=n,m.current.srcObject=n,p.emit("start-stream",{streamId:"your-stream-id"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error starting stream:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),b=function(){S.current&&janusInstance.attach({plugin:"janus.plugin.rtmp",success:function(e){e.createOffer({media:{video:S.current.getVideoTracks()[0],audio:S.current.getAudioTracks()[0]},success:function(n){e.send({message:{request:"publish",rtmp:"rtmp://janus:8188/stream"},jsep:n}),u(!0)},error:function(e){console.error("Error creating SDP offer:",e)}})},error:function(e){console.error("Error attaching RTMP plugin:",e)}})};return(0,i.jsxs)("div",{className:"streaming-container",children:[(0,i.jsxs)("div",{className:"video-wrapper",children:[(0,i.jsx)("video",{ref:m,autoPlay:!0,muted:!0,className:"video-feed"}),!f&&(0,i.jsx)("div",{className:"overlay",children:"Connecting..."})]}),(0,i.jsxs)("div",{className:"control-panel",children:[(0,i.jsx)("h2",{children:"Live Stream Control"}),(0,i.jsxs)("div",{className:"status-indicators",children:[(0,i.jsx)("div",{className:"status ".concat(f?"connected":"disconnected"),children:f?"Connected":"Disconnected"}),(0,i.jsx)("div",{className:"status ".concat(t?"live":"idle"),children:t?"Live":"Idle"})]}),(0,i.jsxs)("div",{className:"controls",children:[(0,i.jsxs)("button",{onClick:k,disabled:t||!h,className:"start-btn",children:[(0,i.jsx)(a.gSK,{})," Start Streaming"]}),(0,i.jsxs)("button",{onClick:function(){p.emit("stop-stream",{streamId:"your-stream-id"}),u(!1)},disabled:!t,className:"stop-btn",children:[(0,i.jsx)(a.wFo,{})," Stop Streaming"]})]})]})]})}}}]);
//# sourceMappingURL=42.b5500ad9.chunk.js.map