"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[731],{80731:function(e,n,r){r.r(n),r.d(n,{default:function(){return b}});var t=r(90675),s=r(10467),o=r(5544),i=r(65043),c=r(60184),a=(r(44050),r(58650),r(85522)),u=r(70579),l=function(e){var n=e.status,r=e.isConnected;return(0,u.jsx)(a.az,{p:2,borderRadius:"4px",bg:r?"green.500":"red.500",color:"white",children:n})},d=r(22107),f=r(76659),g=r(39081),h=r(28846),p=r(5371),m=r(38028),x=r(72338),b=function(){var e=(0,i.useRef)(null),n=(0,i.useState)(null),r=(0,o.A)(n,2),a=r[0],b=r[1],j=(0,i.useState)(!1),v=(0,o.A)(j,2),w=v[0],y=v[1],S=(0,i.useState)(!1),C=(0,o.A)(S,2),k=C[0],z=C[1],A=(0,i.useRef)(null),E=(0,i.useRef)(null);(0,i.useEffect)((function(){return R(),function(){T()}}),[]);var R=function(){x.A.init({debug:"all",callback:function(){var n=new x.A({server:"/ws/",success:function(){console.log("Janus Gateway initialized!"),D(n)},error:function(e){console.error("Error initializing Janus Gateway:",e)}});e.current=n}})},D=function(e){e.attach({plugin:"janus.plugin.streaming",success:function(e){console.log("Streaming plugin attached!",e),b(e),z(!0),P(e)},error:function(e){console.error("Error attaching plugin:",e)}})},P=function(){var e=(0,s.A)((0,t.A)().mark((function e(n){var r;return(0,t.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 3:r=e.sent,A.current.srcObject=r,E.current=r,n.createOffer({media:{video:!0,audio:!0},stream:r,success:function(e){console.log("Generated JSEP:",e),n.send({message:{request:"configure",audio:!0,video:!0},jsep:e})},error:function(e){console.error("Error creating WebRTC offer:",e)}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error accessing user media:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n){return e.apply(this,arguments)}}(),T=function(){e.current&&(e.current.destroy(),console.log("Janus destroyed successfully")),E.current&&E.current.getTracks().forEach((function(e){return e.stop()}))};return(0,u.jsxs)(d.a,{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",fontFamily:"Arial, sans-serif",color:"gray.800",children:[(0,u.jsxs)(d.a,{position:"relative",width:"80%",maxWidth:"720px",mb:5,bg:"black",borderRadius:"8px",overflow:"hidden",children:[(0,u.jsx)("video",{ref:A,autoPlay:!0,muted:!0,width:"100%",className:"video-feed"}),!k&&(0,u.jsxs)(d.a,{position:"absolute",top:0,left:0,right:0,bottom:0,bg:"rgba(0, 0, 0, 0.7)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem",children:[(0,u.jsx)(f.y,{size:"lg"}),(0,u.jsx)(g.E,{ml:2,children:"Connecting..."})]})]}),(0,u.jsxs)(d.a,{textAlign:"center",width:"100%",maxWidth:"500px",children:[(0,u.jsx)(h.D,{as:"h2",size:"lg",mb:3,children:"Live Stream Control"}),(0,u.jsxs)(p.s,{justifyContent:"space-around",mb:3,children:[(0,u.jsx)(l,{status:k?"Connected":"Disconnected",isConnected:k}),(0,u.jsx)(l,{status:w?"Live":"Idle",isConnected:w})]}),(0,u.jsxs)(p.s,{justifyContent:"center",gap:3,children:[(0,u.jsx)(m.$,{leftIcon:(0,u.jsx)(c.gSK,{}),onClick:function(){if(a){a.send({message:{request:"publish",rtmp_url:"rtmp://nginx:1935/stream"},success:function(){console.log("Publishing to RTMP successfully!"),y(!0)},error:function(e){console.error("Error publishing to RTMP:",e)}})}else console.error("RTMP plugin not attached.")},isDisabled:w||!k,colorScheme:"green",size:"lg",fontSize:"md",children:"Start Streaming"}),(0,u.jsx)(m.$,{leftIcon:(0,u.jsx)(c.wFo,{}),onClick:function(){a&&(a.hangup(),y(!1),E.current&&E.current.getTracks().forEach((function(e){return e.stop()})))},isDisabled:!w,colorScheme:"red",size:"lg",fontSize:"md",children:"Stop Streaming"})]})]})]})}}}]);
//# sourceMappingURL=731.bf09135d.chunk.js.map